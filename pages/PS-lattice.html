<!DOCTYPE html>
<html lang="en">

  <head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Lattices | Random physics
</title>
    <link rel="canonical" href="/pages/PS-lattice.html">

    <link rel="stylesheet" href="/theme/css/bootstrapr.min.css">
    <link rel="stylesheet" href="/theme/css/font-awesome.min.css">
    <link rel="stylesheet" href="/theme/css/pygments/autumn.min.css">
    <link rel="stylesheet" href="/theme/css/style.css">

    <link rel="icon" type="image/png" href="/extras/rphys.png" sizes="64x64">

<meta name="description" content="Models of solids using the tight binding approximation of the hamiltonian; simple models ofÂ ferromagnetism.">

  </head>

  <body>
    <header class="header">
      <div class="container">
        <div class="row">
          <div class="col-sm-12">
            <h1 class="title"><a href="/">Random physics</a></h1>
            <p class="text-muted">Alberto Verga, research notebook</p>
              <ul class="list-inline">
                  <li class="list-inline-item"><a href="/">Blog</a></li>
                      <li class="list-inline-item text-muted">|</li>
                      <li class="list-inline-item"><a href="/pages/about.html">About</a></li>
                      <li class="list-inline-item"><a href="/pages/lectures.html">Lectures</a></li>
              </ul>
          </div>
        </div>
      </div>
    </header>

    <div class="main">
      <div class="container">

<article class="article">
  <div class="content">
    <p><span class="math">\(\newcommand{\I}{\mathrm{i}} 
\newcommand{\E}{\mathrm{e}} 
\newcommand{\D}{\mathop{}\!\mathrm{d}} 
\newcommand{\bra}[1]{\langle{#1}|}
\newcommand{\ket}[1]{|{#1}\rangle}
\newcommand{\braket}[1]{\langle{#1}\rangle}
\newcommand{\bbraket}[1]{\langle\!\langle{#1}\rangle\!\rangle}&nbsp;\newcommand{\bm}{\boldsymbol}\)</span></p>
<blockquote>
<p><a href="/pages/PS-index.html">Lectures</a> on statistical&nbsp;mechanics.</p>
</blockquote>
<h1>Solids: effective&nbsp;models</h1>
<p>Solid is an ordered state of matter characterized by a crystal structure and electronic bands. Atoms are located on the sites of the crystal lattice, tightly bound to their neighbors, their vibrations give raise to phonons, the quantum of the acoustic modes; electrons, depending on the chemical properties of the atoms, can jump from one site to another, carry a magnetic moment (spin), or interact with the nucleus and crystal potentials through the spin-orbit coupling, giving rise to a wealth of different physical properties and effects, such thermal or electric conductivity, ferromagnetism, piezoelectric effects, quantum Hall conductance, giant magnetoresitence or topological effects. In spite of the complexity of the solid&#8217;s band structure, specific electronic properties can be described by relatively simple effective hamiltonians comprising a few parameters, in which the complex crystal structure is replaced by a regular lattice and the collective electron coulomb interactions, by short range neighbors&nbsp;interactions.</p>
<p>The simplest example is a free electron in a metal. The presence of the crystal periodic potential creates gaps in the continuum spectrum. A tight binding hamiltonian on a cubic lattice, in which the electron can jump from one site to one of its six neighbors, is enough to account for the band structure; the hoping energy <span class="math">\(t\)</span> is the only parameter of the&nbsp;model:
</p>
<div class="math">$$H = - t \sum_{(\boldsymbol x, \boldsymbol y)} \big[c^\dagger({\boldsymbol x}) c({\boldsymbol y}) + c^\dagger({\boldsymbol y}) c({\boldsymbol x})\big]$$</div>
<p>
where <span class="math">\(\boldsymbol y = \{ (x \pm 1,y,z), (x,y\pm1,z), (x,y,z\pm1) \}\)</span>, is a neighbor of the site <span class="math">\(\boldsymbol x \in \mathbb{Z}^3\)</span> of the cubic lattice. The operator <span class="math">\(c({\boldsymbol x})\)</span> annihilate the particle at site <span class="math">\(\boldsymbol x\)</span>:
</p>
<div class="math">$$c^\dagger(x+1,y,z) c(x,y,z) \sim \ket{x+1,y,z} \bra{x,y,z} \,,$$</div>
<p>
its hermitian conjugate <span class="math">\(c^\dagger({\boldsymbol x})\)</span>, creates a particle at this&nbsp;site.</p>
<p>Many universal properties of magnetic systems are well described by the ising&nbsp;hamiltonian,
</p>
<div class="math">$$H = -J \sum_{(\boldsymbol x, \boldsymbol y)} s_{\boldsymbol x} s_{\boldsymbol y}\,,$$</div>
<p>
where <span class="math">\(s_{\boldsymbol x} = \pm 1\)</span> is a classical spin variable, <span class="math">\(J\)</span> is the exchange energy constant, and <span class="math">\((\boldsymbol x, \boldsymbol y)\)</span> are neighboring sites in a lattice. The ising model is a simplified version of the quantum heisenberg&nbsp;hamiltonian:
</p>
<div class="math">$$H = -J\sum_{(\boldsymbol x, \boldsymbol y)} \boldsymbol\sigma_{\boldsymbol x} \cdot \boldsymbol\sigma_{\boldsymbol y}\,,$$</div>
<p>
where <span class="math">\(\sigma\)</span> is the vector of pauli matrices. The ising and heisenberg hamiltonians, describe a magnetic material as a set of spins (classical or quantum), attached to the sites of a lattice (linear, square or cubic, depending on the dimension, for example), interacting with their nearest neighbors via the <span class="math">\(J\)</span> exchange coupling (mimicking the overlap of electronic&nbsp;functions).</p>
<blockquote>
<p><img src="/images/PS-ising_spins.png" height="200"></p>
<p>Ising model of a ferromagnetic material. Two dimensional lattice of interacting neighboring spins. The gray region defines a cluster of up&nbsp;spins.</p>
</blockquote>
<p>More generally, <em>lattice models</em> are useful in a variety of domains, ranging from condensed matter to biology or social sciences. They can describe statistical equilibrium properties, like phase transitions, or nonequilibrium processes, like crystal growth,<sup id="fnref:BS"><a class="footnote-ref" href="#fn:BS">1</a></sup> population dynamics in a living system,<sup id="fnref:KR"><a class="footnote-ref" href="#fn:KR">3</a></sup> or opinion propagation in a social network.<sup id="fnref:BV"><a class="footnote-ref" href="#fn:BV">2</a></sup></p>
<h2>Free particles in a&nbsp;lattice</h2>
<p>We consider a gas of noninteracting, spinless bosons in a cubic lattice of step size <span class="math">\(a=1\)</span>, which we take as the length unit (fermions can be treated similarly). The system&#8217;s hamiltonian&nbsp;is,
</p>
<div class="math">$$H_N = \sum_{n=1}^N H_n\,, \quad H_n = - t \sum_{(\boldsymbol x, \boldsymbol y)} [a^\dagger_n({\boldsymbol x}) a_n({\boldsymbol y}) + a^\dagger_n({\boldsymbol y}) a_n({\boldsymbol x})]\,,$$</div>
<p>
where <span class="math">\(N\)</span> is the number of particles and the operators create or annihilate particle <span class="math">\(n\)</span> at a lattice site <span class="math">\(\boldsymbol x \in \mathbb{Z}^3\)</span>. In order to write the grand potential we diagonalize the hamiltonian using a change of the position basis <span class="math">\(\boldsymbol x\)</span>, to the momentum <span class="math">\(\boldsymbol k\)</span> basis, through the fourier&nbsp;transformation,
</p>
<div class="math">$$a_n({\boldsymbol x}) = \frac{V}{(2\pi)^3} \int_{-\pi}^\pi \D \boldsymbol k \, \E^{-\I \boldsymbol k \cdot \boldsymbol x} a_n({\boldsymbol k})\,,$$</div>
<p>
where <span class="math">\(V=L^3\)</span> is the number of sites in the cubic lattice of edge <span class="math">\(L\)</span>, the integration is over the first &#8220;brillouin zone&#8221; (here, the cube <span class="math">\(\mathrm{BZ} = (-\pi,\pi)^3\)</span> in momentum space). Note that the inverse transformation&nbsp;gives,
</p>
<div class="math">$$a_n({\boldsymbol k}) = \frac{1}{V} \sum_{\boldsymbol x} \E^{\I \boldsymbol k \cdot \boldsymbol x} a_n({\boldsymbol x})\,,$$</div>
<p>
and&nbsp;that,
</p>
<div class="math">$$a^3\sum_{\bm x} \E^{\I (\bm k - \bm k') \cdot \bm x } = V \delta_{\bm k, \bm k'} \rightarrow (2\pi)^3 \delta( \bm k - \bm k')$$</div>
<p>
is the kronecker delta. In the momentum basis the hamiltonian becomes <strong style="color:DarkSlateBlue; background-color:LightGray;"><span class="caps">EX</span></strong>,
</p>
<div class="math">$$H = \frac{V}{(2\pi)^3} \int_{-\pi}^\pi \D \boldsymbol k \, \epsilon(\boldsymbol k) a^\dagger(\boldsymbol k) a(\boldsymbol k)\,,$$</div>
<p>
where
</p>
<div class="math">$$\epsilon(\boldsymbol k) = -2(\cos k_x + \cos k_y + \cos k_z)\,.$$</div>
<p>
Comparing this formula with the one of a free particle one finds that <span class="math">\(t \sim \hbar^2/2ma^2 \rightarrow&nbsp;\infty\)</span> </p>
<p>The grand potential <span class="math">\(\Phi(T,\mu,V)\)</span> of the noninteracting hamiltonian,&nbsp;writes:
</p>
<div class="math">$$\Phi(T,\mu,V) = \frac{TV}{(2\pi)^3} \int_{-\pi}^\pi \D \boldsymbol k \, \ln\left( 1 - \E^{\mu/T} \E^{-\epsilon(\boldsymbol k)/T}  \right)\,,$$</div>
<p>
where <span class="math">\(H\)</span> is the single particle hamiltonian. The number of particles and the energy are given by the&nbsp;integrals,
</p>
<div class="math">$$N = \frac{V}{(2\pi)^3} \int_{-\pi}^\pi \frac{\D \boldsymbol k} {\E^{\mu/T} \E^{\epsilon(\boldsymbol k)/T} - 1} \,,$$</div>
<p>
and
</p>
<div class="math">$$E = \frac{V}{(2\pi)^3} \int_{-\pi}^\pi \D \boldsymbol k \, \frac{\epsilon(\boldsymbol k)}{\E^{\mu/T} \E^{\epsilon(\boldsymbol k)/T} - 1} \,.$$</div>
<p>To compare the behavior of the gas in a lattice with the ideal gas, we keep the first term in the fugacity (Boltzmann limit, which is similar for fermions and bosons). In this limit we&nbsp;have,
</p>
<div class="math">\begin{align*}
\Phi &amp; = - \frac{TV \E^{\mu/T}}{(2\pi)^3} \int_{-\pi}^\pi \D \boldsymbol k \,\E^{\epsilon(\boldsymbol k)/T} \\
&amp; = - \frac{TV \E^{\mu/T}}{(2\pi)^3} \left[\int_{-\pi}^\pi \D k \, \E^{2t \cos k/T} \right]^3\\
&amp; = - TV \E^{\mu/T} I_0(2t/T)^3\,,
\end{align*}</div>
<p>
where <span class="math">\(I_0\)</span> is the modified bessel function of the first&nbsp;kind,
</p>
<div class="math">$$I_0(z) = \frac{1}{\pi} \int_0^\pi \D t \, \E^{z \cos t}\,,$$</div>
<p>
and the particle&nbsp;number,
</p>
<div class="math">$$N = \frac{V \E^{\mu/T}}{(2\pi)^3} \left[\int_{-\pi}^\pi \D k \, \E^{2t \cos k/T} \right]^3 = V \E^{\mu/T} I_0(2t/T)^3\,,$$</div>
<p>
which combined with the expression of <span class="math">\(\Phi= -PV\)</span>, one&nbsp;recovers
</p>
<div class="math">$$PV = NT$$</div>
<p>
independent of the hoping energy <span class="math">\(t\)</span>. However, the lattice gas energy differs from the one of the ideal&nbsp;gas.</p>
<p>Indeed, the energy is given&nbsp;by,
</p>
<div class="math">$$E = -2t\frac{V \E^{\mu/T}}{(2\pi)^3} \left[\int_{-\pi}^\pi \D k \, \cos k \, \E^{2t \cos k/T} \right]^3 = -2TV \E^{\mu/T} I_1(2t/T)^3\,,$$</div>
<p>
or, eliminating the chemical&nbsp;potential,
</p>
<div class="math">$$E = -2tN \left[\frac{I_1(2t/T)}{I_0(2t/T)} \right]^3\,.$$</div>
<p>
In the limit dominated by the kinetic energy <span class="math">\(T \ll t\)</span>, <span class="math">\(E\)</span> approximates <strong style="color:DarkSlateBlue; background-color:LightGray;"><span class="caps">EX</span></strong>,
</p>
<div class="math">$$E \approx -2tN \frac{1-9T/16t}{1+3T/t} = -2tN + \frac{3}{2}NT\,,$$</div>
<p>
where the second term corresponds to the ideal gas result (the first term, a constant independent of the temperature, do not contribute to the specific heat, can be eliminated by a shift of the zero of the energy). We used the asymptotic&nbsp;expression,
</p>
<div class="math">$$I_n(z) \approx \frac{\E^z}{\sqrt{2\pi z}} \left( 1 - \frac{4n^2 - 1}{8 z}  \right)\,.$$</div>
<p>
In the opposite limit <span class="math">\(T \gg t\)</span>, the energy grows slowly with the&nbsp;temperature:
</p>
<div class="math">$$E \approx -2tN \left( \frac{t}{T} \right)^3\,,$$</div>
<p>
which gives a specific heat decreasing at high temperature, behavior consistent with the exponentially low probability of jumps. (The small <span class="math">\(z\)</span> limit of the <span class="math">\(I\)</span> bessel functions is <span class="math">\(I_n(z) = (z/2)^n/n!\)</span>.)</p>
<h2>One dimensional spin&nbsp;model</h2>
<p>In the presence of an external field <span class="math">\(B\)</span>, the one dimensional ising hamiltonian&nbsp;is,
</p>
<div class="math">$$H = -J\sum_{x=1}^N s_x s_{x+1} - \sum_{x=1}^N s_x B$$</div>
<p>
where we assumed periodic boundary conditions <span class="math">\(s_1 = s_{N+1}\)</span>. We choose units based on the lattice constant and the spin magnetic moment, <span class="math">\(a = g\mu_\text{B}=1\)</span> (we also put the permeability <span class="math">\(\mu_0=1\)</span>); in such units the magnetic field <span class="math">\(B\)</span> has the dimensions of the&nbsp;energy.</p>
<p>The probability of a spin configuration <span class="math">\(s\)</span>,
</p>
<div class="math">$$s = \{s_1=\pm1, s_2=\pm1, \ldots, s_N=\pm 1\}$$</div>
<p> 
is,
</p>
<div class="math">$$P[s] = \frac{1}{Z} \prod_x \exp\left[\frac{J}{T} s_x s_{x+1} + \frac{B}{2T}(s_x + s_{x+1})  \right]$$</div>
<p>
and the partition function is given&nbsp;by,
</p>
<div class="math">$$Z(T,B) = \sum_s \prod_x \exp\left[K s_x s_{x+1} + \frac{B}{2T} (s_x + s_{x+1})  \right] \,,$$</div>
<p>
where <span class="math">\(K = J/T\)</span>. We observe that the thermodynamics of the present model depends on two nondimensional parameters, the interaction energy-temperature ratio <span class="math">\(K = J/T\)</span> and the external field-temperature ratio <span class="math">\(h = B/T\)</span>.
The idea to compute the partition function is to try (obviously this is not always possible) to factor it in a series of identical terms, like in the noninteracting case; we symmetrized the <span class="math">\(B\)</span> term to this goal. We note first that the product appearing in <span class="math">\(Z\)</span> can be written in the&nbsp;form,
</p>
<div class="math">$$\prod_x \exp\left[K s_x s_{x+1} + \frac{B}{2T} (s_x + s_{x+1})\right] = T_{s_1,s_2} T_{s_2,s_3}\ldots T_{s_N,s_1}\,,$$</div>
<p>
where each term <span class="math">\(T_{s_x,s_{y}} = T_{s_y,s_x}\)</span> can take different values according to the values of <span class="math">\(s_x = \pm 1\)</span> and <span class="math">\(s_{y} = \pm 1\)</span>:
</p>
<div class="math">$$T_{s_x,s_y} = \{\E^{K \pm h}, \E^{-K}\}\,.$$</div>
<p>
Therefore, the partition function&nbsp;becomes,
</p>
<div class="math">$$Z = \sum_{s_1} \sum_{s_2} \ldots \sum_{s_N}  T_{s_1,s_2} T_{s_2,s_3}\ldots T_{s_N,s_1}\,.$$</div>
<p>
A generic factor&nbsp;is,
</p>
<div class="math">$$\sum_{s_x} T_{s_{x-1},s_x} T_{s_x,s_{x+1}} = T^2_{s_{x-1},s_{x+1}}\,,$$</div>
<p>
corresponding to the product of two&nbsp;matrices,
</p>
<div class="math">$$T = \begin{pmatrix}
     \E^{K+h} &amp; \E^{-K} \\
     \E^{-K} &amp; \E^{K-h} \\
     \end{pmatrix} \,.$$</div>
<p>
Using the <em>transfer matrix</em> <span class="math">\(T\)</span> to write the partition&nbsp;function, 
</p>
<div class="math">$$Z =  \mathrm{Tr}\, T^N\,.$$</div>
<p>
Therefore, using the invariance of the trace under basis transformations <strong style="color:DarkSlateBlue; background-color:LightGray;"><span class="caps">EX</span></strong>, 
</p>
<div class="math">$$Z = \lambda_+^N + \lambda_-^N$$</div>
<p> 
where <span class="math">\(\lambda_\pm\)</span> are the eigenvalues of the transfer matrix <span class="math">\(T\)</span>:
</p>
<div class="math">$$\lambda_\pm = \E^K \cosh h \pm \sqrt{\E^{2K}\sinh^2h + \E^{-2K}}\,.$$</div>
<p>
In the thermodynamic limit <span class="math">\(N\rightarrow\infty\)</span>, only the larger eigenvalue of the transfer matrix survives in <span class="math">\(Z\)</span>:
</p>
<div class="math">$$Z = \lambda_+^N+\lambda_-^N= \lambda_+^N \big[1 + (\lambda_-/\lambda_+)^N \big] \approx \lambda_+^N\,,$$</div>
<p>
from which we compute the free&nbsp;energy,
</p>
<div class="math">$$F(T,B) = -N T \ln\left( \E^{J/T} \cosh(B/T) + \sqrt{\E^{2J/T}\sinh^2(B/T) + \E^{-2J/T}}  \right)\,.$$</div>
<p>
The mean magnetization per particle <span class="math">\(m=M/N \braket{s_x}\)</span>, is given by <strong style="color:DarkSlateBlue; background-color:LightGray;"><span class="caps">EX</span></strong>,
</p>
<div class="math">$$m = -\frac{1}{N}\frac{\partial F}{\partial B} = \frac{\E^{2J/T}\sinh(B/T)}{\sqrt{\E^{4J/T}\sinh^2(B/T) + 1}}\,.$$</div>
<p>
In the limit of small <span class="math">\(B\)</span> (and finite temperature), the magnetization is proportional to the&nbsp;field:
</p>
<div class="math">$$m \approx \chi B\,, \quad \chi = \frac{\E^{2J/T}}{T}\,,$$</div>
<p>
a behavior of the paramagnetic type, with a susceptibility inversely proportional to the temperature, corrected with the factor <span class="math">\(\E^{J/T}\)</span> depending on the interaction energy. However, for <span class="math">\(T=0\)</span>, te magnetization&nbsp;becomes,
</p>
<div class="math">$$m = \mathrm{sgn}(B)\,,$$</div>
<p>
behavior reminiscent to a <em>phase transition</em> (at critical temperature <span class="math">\(T_c=0\)</span>): indeed, at zero temperature the two values of the magnetization <span class="math">\(m=\pm1\)</span> correspond to an ordered state with all spins pointing up or&nbsp;down.</p>
<p>The correlation function (at <span class="math">\(B=0\)</span>) between two spins separated by a distance <span class="math">\(r\)</span>, is defined&nbsp;by,
</p>
<div class="math">$$C(r) = \langle s_x s_{x + r} \rangle = \sum_s s_x s_{x + r} P[s] =   \frac{1}{Z} \sum_s s_x s_{x + r}   \prod_y \E^{J s_y s_{y+1}/T}\,.$$</div>
<p>
We introduce as before, the transfer matrix <span class="math">\(T\)</span>,
</p>
<div class="math">$$\frac{1}{Z} \sum_s \prod_{y=1}^{x-1} T_{s_ys_{y+1}}s_x \prod_{y=x}^{x+r-1}  T_{s_ys_{y+1}} s_{x+r} \prod_{y=x+r}^{N} T_{s_ys_{y+1}}\,,$$</div>
<p>
which gives, using the matrix product&nbsp;formula,
</p>
<div class="math">$$C(r) = \mathrm{Tr\ } T^{x-1} \sigma_z T^{r} \sigma_z T^{N-r-x+1}\,.$$</div>
<p>
Using now the unitary&nbsp;transformation,
</p>
<div class="math">$$U = \frac{1}{\sqrt{2}} \begin{pmatrix} 1 &amp; 1 \\ 1 &amp; -1 \end{pmatrix}\,,$$</div>
<p>
to diagonalize <span class="math">\(T\)</span>, and the cyclic property of the trace <span class="math">\(\mathrm{Tr}\, ABC = \mathrm{Tr}\, (U^\dagger A U)( U^\dagger B U)( U^\dagger C U)\)</span>, we obtain <strong style="color:DarkSlateBlue; background-color:LightGray;"><span class="caps">EX</span></strong>,
</p>
<div class="math">$$C(r) = \frac{1}{Z} \mathrm{Tr\ }   \begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \end{pmatrix} \begin{pmatrix} \lambda_+^{r} &amp; 0 \\ 0 &amp; \lambda_-^{r} \end{pmatrix} \begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \end{pmatrix} \begin{pmatrix} \lambda_+^{N-r} &amp; 0 \\ 0 &amp; \lambda_-^{N-r} \end{pmatrix}\,.$$</div>
<p>
Therefore the two spins correlation function of a Ising system with <span class="math">\(N\)</span> spins is given by the explicit&nbsp;formula,
</p>
<div class="math">$$C(r) = \langle s_{x}s_{x+r}\rangle  =   \frac{\lambda_+^{N-r}\lambda_-^{r} +    \lambda_+^{r}\lambda_-^{N-r}}{   \lambda_+^N+\lambda_-^N}$$</div>
<p>
In the thermodynamic limit <span class="math">\(N \rightarrow \infty\)</span>, we finally&nbsp;get,
</p>
<div class="math">$$C(r) =  \left(\frac{\lambda_-}{\lambda_+}\right)^r =  \E^{-r/\xi},\;   \xi = -\frac{1}{\ln \tanh J/T} \,,$$</div>
<p>
where <span class="math">\(\xi\)</span> is the <em>correlation length</em>. The exponential decay of correlations indicates the absence of long range order. The 1D Ising model has not phase transitions for <span class="math">\(T&gt;0\)</span>.</p>
<h2>Mean field spin&nbsp;model</h2>
<p>Instead of considering the nearest neighbor interaction, we can investigate the case of long range interaction, where each spin on a lattice indexed by <span class="math">\(x=1,2,\ldots,N\)</span> (<span class="math">\(N\)</span> is the number of spins) can interact with all other&nbsp;spins:
</p>
<div class="math">$$H=-\frac{J}{2N} \sum_{x,y} s_x s_y - B \sum_x s_x\,,$$</div>
<p>
where the factor two is to avoid counting twice each pair <span class="math">\((x,y)\)</span>, and the factor <span class="math">\(1/N\)</span> is to ensure that the energy is extensive (there are <span class="math">\(\sim N^2\)</span> terms of order one in the sum). This model is easily solved by noting that the hamiltonian corresponds to one spin in an effective field <span class="math">\(B_s\)</span> created by the other spins, in addition to the real applied&nbsp;field:
</p>
<div class="math">$$B_s = \frac{J}{N}\sum_x s_x + B = Jm + B\,,$$</div>
<p>
where
</p>
<div class="math">$$m = \frac{1}{N}\sum_x s_x,$$</div>
<p>
is the magnetization per site, or, inserting this expression into <span class="math">\(H\)</span>,
</p>
<div class="math">$$H = \frac{NJ}{2} m^2 - B_s\sum_x s_x\,,$$</div>
<p>
The partition function is&nbsp;then,
</p>
<div class="math">$$Z = [\E^{-Jm^2/2T} 2\cosh(B_s/T)]^N\,.$$</div>
<p>
the free energy&nbsp;is,
</p>
<div class="math">$$F(T,B) = \frac{NJ}{2} m^2 -NT \ln\left( 2\cosh\frac{B_s}{T} \right)\,,$$</div>
<p>
and the magnetization is given by the self-consistent&nbsp;equation,
</p>
<div class="math">$$m = \tanh\left( \frac{Jm + B}{T} \right)\,.$$</div>
<p>
At variance to the one dimensional case, the mean free model account for the existence of a non zero magnetization, even in the absence of an external magnetic field. Such a state is called ferromagnetic: it is a thermodynamic phase with ordered spins and spontaneous magnetization; it differs to the disordered paramagnetic phase, whose spontaneous magnetization vanishes. Therefore, the mean field model is able to describe a magnetic system undergoing, as a function of the temperature and magnetic field, a phase transition from a disordered state at high temperatures, to an ordered state at low temperatures. The critical temperature is given by <span class="math">\(T_c=J\)</span>. For <span class="math">\(T &gt; T_c\)</span>, only the value <span class="math">\(m = m_P(T) = 0\)</span> is solution, while for <span class="math">\(T,T_c\)</span> two equilibrium values are found <span class="math">\(m = \pm m_F(T)\)</span>, corresponding to the paramagnetic and ferromagnetic phases&nbsp;respectively.</p>
<p>Let us compute the heat capacity and the susceptibility in the present framework. Calculating the derivative of  the free energy with respect to the temperature we find the energy <strong style="color:DarkSlateBlue; background-color:LightGray;"><span class="caps">EX</span></strong>,
</p>
<div class="math">$$\frac{E}{N} = -mB - \frac{Jm^2}{2}\,, \quad m = m_P,\pm m_F\,,$$</div>
<p>
in the form of an implicit function of the temperature, through the equilibrium value of the magnetization (<span class="math">\(m_P\)</span> or <span class="math">\(\pm m_F\)</span>). The derivative of <span class="math">\(E\)</span> with respect to <span class="math">\(T\)</span> gives the specific&nbsp;heat,
</p>
<div class="math">$$c_V = \frac{1}{T^2} \frac{\left(B + J m\right)^2}{ \cosh^{2}{\left (\frac{B + J m}{T} \right )} - \frac{J}{T} }\,, \quad m = m_P,\pm m_F\,,$$</div>
<p>
where we used the expression of the&nbsp;derivative,
</p>
<div class="math">$$\frac{\D m}{\D T} = -\frac{ \frac{\D g}{\D T} }{ \frac{\D g}{\D m} } \,,\quad g = m - \tanh\left( \frac{Jm + B}{T} \right)\,.$$</div>
<p>
The susceptibility is computed using also the derivative of the implicit function <span class="math">\(m=m(T)\)</span>,
</p>
<div class="math">$$\chi = \frac{1}{T} \left[\cosh^{2}{\left (\frac{J m}{T} \right ) - \frac{J}{T}}\right]^{-1}\,, \quad m = m_P,\pm m_F\,,$$</div>
<p> 
at <span class="math">\(B=0\)</span>.</p>
<blockquote>
<p><img src="/images/PS-mT.png" height="200">
<img src="/images/PS-chi.png" height="200"></p>
<p>Magnetization and susceptibility as a function of the temperature (<span class="math">\(B=0\)</span>). A phase transition occurs at <span class="math">\(T=T_c\)</span> between a height temperature disordered state <span class="math">\(m=0\)</span> (paramagnetic) and a low temperature ordered state <span class="math">\(m \ne 0\)</span> (ferromagnetic); at the transition temperature the susceptibility&nbsp;diverges.</p>
</blockquote>
<p>The specific heat (at zero magnetic&nbsp;field),
</p>
<div class="math">$$C = \frac{\partial E}{\partial T} = -\frac{NJ}{2} \frac{\D m^2}{\D T}$$</div>
<p>
presents a discontinuity at the critical temperature. This behavior is specific of the mean field approximation, more realistic models give a divergence of the&nbsp;form,
</p>
<div class="math">$$C \sim c_\pm |T-T_c|^{-\alpha}$$</div>
<p>
characterized by the exponent <span class="math">\(\alpha\)</span>.</p>
<blockquote>
<p><img src="/images/PS-cv.png" height="200"></p>
<p>Specific heat capacity of the ferromagnet as a function of the temperature; at the critical temperature it has a jump of <span class="math">\(3\)</span>. In the paramagnetic state the specific heat of the magnet&nbsp;vanishes.</p>
</blockquote>
<h2>Monte Carlo&nbsp;method</h2>
<p>Second order phase transitions arise in magnetic materials, superfluids, superconductors, liquid crystals, and solid allows; although microscopically different, they are described by the same critical exponents: they are examples of order-disorder&nbsp;transitions.</p>
<p>The study of critical properties of physical systems near a phase transition relies, for a large part, on numerical&nbsp;simulation:</p>
<ul>
<li>Monte Carlo methods: allow the investigation of (classical and quantum) equilibrium&nbsp;systems.</li>
<li>Kinetic Monte Carlo: suitable for nonequilibrium&nbsp;systems</li>
<li>Molecular dynamics: used in soft matter (liquids,&nbsp;polymers)</li>
</ul>
<p>Monte Carlo methods are based on a Markovian process, they reject or retain a given modification in the state of a system at each step, provided the change <em>optimize</em> some suitable functional (the energy, for a mechanical system; the Gibbs distribution, for a thermodynamic&nbsp;system) </p>
<p>The dynamics of weakly nonequilibrium systems, well approximated by a Markovian process, or systems relaxing towards the equilibrium, is described by a master equation. It gives the probability <span class="math">\(P\)</span> that a system <span class="math">\(S\)</span> be at state <span class="math">\(s\)</span> at time <span class="math">\(t+1\)</span> given its state at <span class="math">\(t\)</span> is the same <span class="math">\(s\)</span> or other possible configuration <span class="math">\(s'\)</span>,
</p>
<div class="math">$$P(s,t + 1) - P(s,t) = \sum_{s'}\big[ T(s' \rightarrow s) P(s',t) - T(s \rightarrow s') P(s,t) \big]$$</div>
<p>
where <span class="math">\(T\)</span> is the transition probability between states <span class="math">\(s\)</span> and <span class="math">\(s'\)</span>, not necessarily equivalent in the two directions. The sum is over all possible configurations of the system, <span class="math">\(s' \ne s\)</span>. At the stationary state the right hand side must vanish. A sufficient condition&nbsp;is,
</p>
<div class="math">$$T(s' \rightarrow s) P(s') = T(s \rightarrow s') P(s)\,,$$</div>
<p>
which is called <em>detailed&nbsp;balance</em></p>
<p>The <em>Metropolis</em> method, uses the thermodynamic equilibrium Gibbs distribution as the stationary probability&nbsp;distribution,
</p>
<div class="math">$$P(s) = \frac{ \E^{-\beta E(s)}  }{Z}\,, \quad \beta = 1/T$$</div>
<p>
(<span class="math">\(\beta\)</span> is the usual notation of the inverse temperature). It is convenient to write the transition probability in the form <span class="math">\(T(s \rightarrow s') = w_s A_{ss'}\)</span>,&nbsp;where:</p>
<ul>
<li><span class="math">\(w\)</span> is the trial step probability, for the ising system this is the probability to choose a random site in the lattice and change its&nbsp;spin</li>
<li>and <span class="math">\(A\)</span> is the acceptance probability
    <div class="math">$$\frac{A_{ss'}}{A_{s's}} = \frac{P(s')}{P(s)} = \E^{\beta E(s) - \beta E(s')}$$</div>
    one has,
    <div class="math">$$\frac{T(s \rightarrow s')}{T(s' \rightarrow s)}   = \frac{w_{s}}{w_{s'}} \frac{A_{ss'}}{A_{s's}}= \frac{P(s')}{P(s)}$$</div>
    where we assumed symmetric trials <span class="math">\(w_{s}= w_{s'}\)</span>.</li>
</ul>
<p>The metropolis algorithm proceeds in two steps: given a configuration <span class="math">\(s\)</span></p>
<ul>
<li>we choose a new configuration <span class="math">\(s'\)</span> with probability <span class="math">\(w_{s}\)</span></li>
<li>if the probability of this configuration satisfies <span class="math">\(P(s') &gt; P(s)\)</span> then we accept the new configuration
    <div class="math">$$A_{ss'} = 1,\ \text{if } P(s') \ge P(s)$$</div>
    otherwise, we put
    <div class="math">$$A_{ss'} =   \frac{P(s')}{P(s)} ,\ \text{if } P(s') &lt; P(s)$$</div>
    and accepts <span class="math">\(s'\)</span> with probability <span class="math">\(A_{ss'}\)</span>, in summary:
    <div class="math">$$A_{ss'} = \min[1, P(s')/P(s)]$$</div>
</li>
</ul>
<p>This algorithm ensures that the detailed balance condition is satisfied and that the asymptotic, stationary, probability distribution is the Gibbs distribution at the given&nbsp;temperature.</p>
<p>In the metropolis algorithm only one spin at each step is reversed; near the transition, where the spins are in large patches having the same orientation (clusters), the rejection probability is large. To remedy at this, simultaneous reversal of many spins is much more efficient. This is the idea of the Wolff <em>cluster algorithm</em>.</p>
<p>At variance to the metropolis algorithm which supposed the trial probability independent on the configuration, let us assume that <span class="math">\(w_s \ne w_{s'}\)</span>. The condition of detailed balance&nbsp;becomes,
</p>
<div class="math">$$w_s A_{ss'}P(s) = w_{s'} A_{s's}P(s')$$</div>
<p>
For the construction of the cluster we must specify in addition to the Gibbs weights, the rules of accepting or rejecting the&nbsp;configuration. </p>
<p>Let us consider a <span class="math">\(s=1\)</span> cluster <span class="math">\(C\)</span>; there are <span class="math">\(n_1\)</span> pairs <span class="math">\((1,1)\)</span> and <span class="math">\(n_2\)</span> pairs <span class="math">\((1,-1)\)</span> at its border <span class="math">\(\partial C\)</span>. The contribution of the border to the energy&nbsp;is 
</p>
<div class="math">$$E_{\partial C} = n_1 - n_2$$</div>
<p>
(in units of the exchange constant <span class="math">\(J=1\)</span>). The gibbs probability of the <span class="math">\(s\)</span> spin configuration, is&nbsp;then 
</p>
<div class="math">$$P(s) \sim \E^{-\beta(n_1-n_2)}$$</div>
<p>
If <span class="math">\(p\)</span> is the probability to add a site to the cluster, we can assume the form trial probability associated to <span class="math">\(s\)</span>, to&nbsp;be
</p>
<div class="math">$$w_{s} \sim (1-p)^{n_2}$$</div>
<p>
which gives the <em>a priori</em> probability to stop growing the cluster <span class="math">\(s\)</span> whose spins will be reversed (leading to a new configuration <span class="math">\(s'\)</span>). Therefore, using similar rules to go back to the configuration <span class="math">\(s\)</span> from <span class="math">\(s'\)</span>, the acceptance probability is given by the&nbsp;rule,
</p>
<div class="math">$$A_{ss'} = \min{ \left[1, \frac{\E^{-\beta(n_2-n_1)}}{\E^{-\beta(n_1-n_2)}} \frac{(1-p)^{n_1}}{(1-p)^{n_2}} \right] }  = 1,\ \text{if } p=1-\E^{2\beta}$$</div>
<p>
this means that with this special value of <span class="math">\(p\)</span>, once the cluster is formed, we reverse it with probability <span class="math">\(1\)</span>. It is the existence of this special value of <span class="math">\(p\)</span>, leading to full acceptance, that makes the algorithm particularly&nbsp;performant.</p>
<h3>Numerical computation of the ising&nbsp;model</h3>
<p>We consider the ising model in a square lattice of size <span class="math">\(L\)</span>,
</p>
<div class="math">$$H=-\sum_{\langle x,y \rangle} s_x s_y\,,\quad x,y = 0,1,\ldots, L^2 - 1$$</div>
<p>
(with <span class="math">\(J=1\)</span> the energy unit and where the sum runs over the nearest neighbors) was exactly solved by <a href="/pages/PS-onsager.html">Onsager (1944)</a>. It undergoes a ferromagnetic transition at the&nbsp;temperature
</p>
<div class="math">$$T_c = 2/\log(1+\sqrt{2})\,.$$</div>
<p>
The magnetization per site <span class="math">\(m=\sum_x s_x/L^2\)</span> is near <span class="math">\(1\)</span> in the low temperature ferromagnetic state, and near <span class="math">\(0\)</span> in the high temperature paramagnetic state. At the transition point the heat&nbsp;capacity
</p>
<div class="math">$$c_V\approx \log|1-T/T_c|$$</div>
<p>
has a logarithmic cusp and the&nbsp;susceptibility
</p>
<div class="math">$$\chi \sim |1-T/T_c|^{-\gamma}$$</div>
<p>
diverges as a power law with a characteristic exponent <span class="math">\(\gamma = 7/4\)</span>. The magnetization is given by the&nbsp;formula,
</p>
<div class="math">$$m(T) = \left[1 - \sinh^{-4}\frac{2}{T} \right]^{1/8}$$</div>
<p>
which gives, near the transition, also a power law with characteristic exponent <span class="math">\(\beta=1/8\)</span> (the mean field gives <span class="math">\(\beta=1/2\)</span>).</p>
<p>We use the monte carlo method to investigate the statistical properties of the ising system; here we gives, as an example, the two dimensional routines of the metropolis and cluster&nbsp;algorithms.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#</span>
<span class="c1"># Metropolis algorithm</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">metropolis</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">kT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reference:</span>
<span class="sd">        Newman, M and Barkema, G., *Monte Carlo Mehtods</span>
<span class="sd">        in statistical physics* (Oxford, 1999), </span>
<span class="sd">        Chap. 3 and p. 433.</span>
<span class="sd">    Input:</span>
<span class="sd">        s spin configuration</span>
<span class="sd">        temperature kT (in units of J)</span>
<span class="sd">    Output:</span>
<span class="sd">        new configuration s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">flips</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">flips</span> <span class="o">&lt;=</span> <span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="n">L</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
        <span class="c1"># compute energy required to flip spin</span>
        <span class="n">dE</span> <span class="o">=</span> <span class="n">s</span><span class="p">[(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">L</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">L</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">x</span><span class="p">,(</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">L</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">x</span><span class="p">,(</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">L</span><span class="p">]</span>
        <span class="n">dE</span> <span class="o">*=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">s</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span>
        <span class="c1"># Metropolis algorithm to see if we should accept trial</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dE</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">kT</span><span class="p">)):</span>
            <span class="c1"># accept trial: reverse spin; return dE and dM</span>
            <span class="n">s</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">flips</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">s</span>
<span class="c1"># Energy and magnetization (one MC step)</span>
<span class="k">def</span> <span class="nf">thermo</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="c1"># Use: (M, E) = thermo(s)</span>
    <span class="n">dE</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="n">roll</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">roll</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> 
              <span class="n">roll</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">roll</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="o">-</span><span class="nb">sum</span><span class="p">(</span><span class="n">dE</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">#</span>
<span class="c1"># Cluster algorithm</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">flip_cluster</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">kT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    References:</span>
<span class="sd">        Wolff cluster algorithm, Phys. Rev. Lett. **62**, 361 (1985)</span>
<span class="sd">        Newman, M and Barkema, G., *Monte Carlo Mehtods</span>
<span class="sd">        in statistical physics* (Oxford, 1999), </span>
<span class="sd">        Chap. 4.2 and p. 437.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="n">kT</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="n">flips</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># number of flips</span>
    <span class="c1"># sweep the lattice once</span>
    <span class="k">while</span> <span class="n">flips</span> <span class="o">&lt;=</span> <span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
        <span class="c1"># initialize cluster on a random site</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="n">L</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
        <span class="n">cluster</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span> <span class="c1"># cluster stack</span>
        <span class="n">s_in</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
        <span class="n">s_out</span> <span class="o">=</span> <span class="o">-</span><span class="n">s</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="c1"># and flip it</span>
        <span class="n">s</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_out</span>
        <span class="n">flips</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1"># update count</span>
        <span class="k">while</span> <span class="n">cluster</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="c1"># remove the first site of the cluster stack</span>
            <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1"># check neighbors for acceptance</span>
            <span class="n">neighbors</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">L</span><span class="p">),</span> <span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">L</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
                         <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">L</span><span class="p">)</span><span class="o">%</span><span class="n">L</span><span class="p">),</span> <span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">L</span><span class="p">)</span><span class="o">%</span><span class="n">L</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">neighbors</span><span class="p">:</span>
                <span class="c1"># is same sign?</span>
                <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">site</span><span class="p">]</span> <span class="o">==</span> <span class="n">s_in</span><span class="p">:</span>
                    <span class="c1"># use the acceptance probability (temp)</span>
                    <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">:</span>
                        <span class="n">cluster</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
                        <span class="n">s</span><span class="p">[</span><span class="n">site</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_out</span>
                        <span class="n">flips</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1"># update flips count</span>
    <span class="k">return</span> <span class="n">s</span>
</code></pre></div>

<p>The figures below show magnetization snapshots of the two phases and at the&nbsp;transition.</p>
<blockquote>
<p><img src="/images/PS-ising-MP-s2.png" height="200">
<img src="/images/PS-ising-MP-s0.png" height="200">
<img src="/images/PS-ising-MP-s1.png" height="200"></p>
<p>Spin configurations (black and white represent the two states at each lattice site) of a 2D ising system below, at, and above the critical temperature, <span class="math">\(T_c \approx 2.269\)</span> (or <span class="math">\(\beta_c=0.4407\)</span>). The critical state characterizes by the existence of ferromagnetic domains having any size, randomly distributed on the lattice. At lower temperature the ordered domain is of the size of the system. At higher temperature, the magnetization is randomly distributed, with zero&nbsp;mean.</p>
</blockquote>
<p>We can also compute the thermodynamic quantities, and observe their singular behavior at the transition. A quantitative comparison with the Onsager formulas can be made. In addition, the method can of course be generalized to take into account an external field, or to go to larger dimensions. In the three dimensional lattice (cubic lattice), the exponent characterizing the vanishing of the magnetization in the paramagnetic state is <span class="math">\(\beta \approx 0.326\)</span>.</p>
<blockquote>
<p><img src="/images/PS-i-CL-m.png" width="200">
<img src="/images/PS-i-CL-e.png" width="200">
<img src="/images/PS-i-CL-c.png" width="200"></p>
<p>Magnetization, energy and heat capacity as a function of the temperature for the 2D ising model, from cluster monte carlo simulations. The heat capacity is shown in the region of the phase transition in a logarithmic scale. The three set of data correspond to <span class="math">\(L=20\)</span> (red), <span class="math">\(L=64\)</span> (gray), and <span class="math">\(L=128\)</span> (black), to emphasize the finite size effect on the singularities present at the thermodynamic limit. The vertical line shows the critical temperature <span class="math">\(T_c=2.269\)</span>.</p>
</blockquote>
<h2>The <span class="caps">XY</span>&nbsp;model</h2>
<p>Some twodimensional systems, like films of liquid helium, ferromagnets or superconducting materials, display a particular phase transition without low temperature order. In the general case second order phase transition are characterized by a low temperature ordered phase, like in a ferromagnet with develops a spontaneous magnetization, or the transition of liquid helium into a superfluid, and a disordered high temperature phase (paramagnetic state or normal liquid phase). One simple model undergoing the so called Kosterlitz-Thouless transition is given by a classical version of the heisengberg spin&nbsp;model:
</p>
<div class="math">$$H =  -\bar{J} \sum_{\braket{\bm x, \bm y}} \bm S_{\bm x} \cdot \bm S_{\bm y} = -\bar{J}S^2 \sum_{\braket{\bm x, \bm y}} \cos(\theta_{\bm x} - \theta_{\bm y}) \,,$$</div>
<p>
where <span class="math">\(J=\bar{JS^2}\)</span> is the characteristic coupling energy, and we sum overt the lattice points <span class="math">\(\bm x\)</span> and its neighbors <span class="math">\(\bm y = \bm x + a \hat{\bm x}\)</span> and <span class="math">\(\bm y = \bm x + a \hat{\bm y}\)</span> (<span class="math">\(a\)</span> is the lattice spacing). The interaction between two neighboring spins <span class="math">\(S_{\bm x}\)</span> and <span class="math">\(S_{\bm y}\)</span>, where <span class="math">\(\bm x, \bm y\in \mathbb{Z}^2\)</span> (the square lattice), reduces to their orientation difference <span class="math">\(\theta_{\bm x} - \theta_{\bm y}\)</span>. The classical model corresponds to a lattice of coupled &#8220;rotators&#8221;, whose degrees of freedom are their possible orientation. We observe that changing the angles by a constant <span class="math">\(\theta_{\bm x} \rightarrow \theta_{\bm x} + \theta_0\)</span>, do not change the hamiltonian; thus, <span class="math">\(\theta_0 \in (-\pi,\pi)\)</span> is a continuous symmetry group parameter, at variance with the discrete symmetry characteristic of the ising model. The presence of a continuous symmetry precludes the existence of a second order phase transition (and a fortiori of higher order singular behavior). However, Kosterlitz and Thouless in a famous paper demonstrated that the correlations between spins separated by a certain distance behaves differently at low temperature, dominated by spin waves, and high temperature, dominated by vortices, a special kind of spin excitations. Our goal is to describe these two particular phases and investigate the nature of the phase transition.<sup id="fnref:xy"><a class="footnote-ref" href="#fn:xy">4</a></sup></p>
<blockquote>
<p><img src="/images/PS-xy_0.svg" width="300"></p>
<p><span class="caps">XY</span> model: classical rotators in a square lattice; the degrees of freedom are the spin direction at each site <span class="math">\(\theta_{\bm x}\)</span>, and neighboring spins at <span class="math">\(\bm x\)</span> and <span class="math">\(\bm y\)</span>, interact through the exchange coupling of strength <span class="math">\(J\)</span>.</p>
</blockquote>
<p>We start by the low temperature behavior, in the region <span class="math">\(T \ll J\)</span>. The ground state of the system at <span class="math">\(T=0\)</span> should be the one with fully aligned spins (note that <span class="math">\(\cos 0 = 1\)</span> gives the weakest coupling); therefore, we expand the cosinus to&nbsp;get
</p>
<div class="math">$$H = E_0 + \frac{J}{2} \sum_{\braket{\bm x, \bm y}} (\theta_{\bm x} - \theta_{\bm y})^2\,.$$</div>
<p>
At low temperature thus, neighboring spin are almost aligned that can be described by a smooth function <span class="math">\(\theta_{\bm x} \rightarrow \theta(\bm x)\)</span> of the position <span class="math">\(\bm x \in \mathbb{R}^2\)</span>, a point in the plane; this replacement is valid if the characteristic length of the orientation gradients are much larger than the lattice length <span class="math">\(a\)</span>. In this <em>continuum description</em> we approximate the angle difference by the angle&nbsp;gradient:
</p>
<div class="math">$$\theta_{\bm x} - \theta_{\bm y} \approx \bm a \cdot \nabla \theta(\bm x)$$</div>
<p>
where <span class="math">\(\bm a = a \hat{\bm x} + a \hat{\bm y}\)</span>. Within the same approximation, we replace the sum over lattice positions by an integral over the real&nbsp;plane,
</p>
<div class="math">$$\sum_{x \in \mathbb{Z}^2} \rightarrow \frac{1}{a^2} \int_{\mathbb{R}^2} \D \bm x\,.$$</div>
<p>Therefore, the effective low temperature hamiltonian&nbsp;reads,
</p>
<div class="math">$$H = E_0 + \frac{J}{2} \int \D \bm x |\nabla \theta(\bm x)|^2\,.$$</div>
<p>
Note that the lattice constant disappears: this is particular to the twodimensional case, in general dimension <span class="math">\(D\)</span> the effective coupling constant would be <span class="math">\(J/a^{D-2}\)</span>. This hamiltonian accounts for the <em>spin wave</em> low temperature excitations above the ferromagnetic ground state. It is worth mentioning that the field <span class="math">\(\theta(\bm x)\)</span> takes values in the interval <span class="math">\((-\pi, \pi)\)</span>, relaxing this constraint amounts at neglecting the multivaluedness of the field, and thus possible topological effects associated to this multivaluedness. We shall return to this important point later. Without topological constraint it is straightforward to compute the thermodynamic properties transforming the low temperature rotators into a field of harmonic oscillators. This can be done by fourier transforming the angle&nbsp;field:
</p>
<div class="math">$$\theta(\bm x) = \frac{1}{\sqrt{N}} \sum_{\bm k} \theta_{\bm k} \E^{\I \bm k \cdot \bm x}\,.$$</div>
<p>
Introducing this transformation into <span class="math">\(H\)</span>, we&nbsp;obtain
</p>
<div class="math">$$H = E_0 + \frac{J}{2} \sum_{\bm k} k^2 \theta_{\bm k} \theta_{-\bm k}\,.$$</div>
<p>
Or taking into account that <span class="math">\(\theta(\bm x)\)</span> is real <span class="math">\(\theta_{-\bm k} = \theta^\star_{\bm k}\)</span>,&nbsp;giving
</p>
<div class="math">$$H = E_0 + \frac{Ja^2}{2} \sum_{\bm k} k^2 |\theta_{\bm k}|^2 \,,$$</div>
<p>
where we used the definition of the kronecker&nbsp;delta:
</p>
<div class="math">$$\frac{1}{a^2}\int_{-L/2}^{L/2} \D x \, \E^{\I k x/a} = N \delta_{k,0}, \quad N= \left(\frac{L}{a}\right)^2 \rightarrow \infty\,.$$</div>
<p>
in which we suppose <span class="math">\(\bm k\)</span> to be dimensionless and put <span class="math">\(\bm x\)</span> explicitly in units of <span class="math">\(a\)</span>, to identify the behavior when <span class="math">\(a \rightarrow 0\)</span>. 
We write the complex field <span class="math">\(\theta_{\bm k} = a_{\bm k} + \I b_{\bm k}\)</span> in terms of the real fields <span class="math">\(a_{\bm k}\)</span> and <span class="math">\(b_{\bm k}\)</span>, to&nbsp;obtain
</p>
<div class="math">$$H = E_0 + Ja^2 \sum_{\bm k &gt; 0} k^2 \left( a_{\bm k}^2 + b_{\bm k}^2 \right)\,.$$</div>
<p>
Therefore, in fourier space the hamiltonian is diagonal with&nbsp;eigenvalues,
</p>
<div class="math">$$\epsilon_{\bm k} = 2J k^2$$</div>
<p>
which is the dispersion relation of ferromagnetic spin waves in the long wavelength limit (in two&nbsp;dimensions).</p>
<p>To characterize the spin waves we need to go further than the mere mean value <span class="math">\(\braket{\theta}\)</span>, which can only assesses the global orientation (in fact, <span class="math">\(\braket{\cos \theta_{\bm x}} = 0\)</span> vanishes for all temperatures <strong style="color:DarkSlateBlue; background-color:LightGray;"><span class="caps">EX</span></strong>); we need instead to know the behavior of the rotators separated by a given distance. The natural quantity measuring the mutual influence of two distant rotators is their <em>correlation function</em>, which we define by the&nbsp;formula
</p>
<div class="math">$$g(\bm x_1, \bm x_2) = \frac{1}{S^2} \braket{\bm S(\bm x_1) \cdot \bm S(\bm x_2)} = \braket{\cos(\theta_{\bm x_1} - \theta_{\bm x_2})}$$</div>
<p>
or&nbsp;equivalently,
</p>
<div class="math">$$g(\bm x) = \mathrm{Re} \left\langle \E^{\I \theta(\bm x)} \E^{ \theta(0)}  \right\rangle \,,$$</div>
<p>
where we used the translation symmetry (the field is homogeneous, their properties do not depend on the origin of coordinates). The mean is computed with respect to the canonical probability&nbsp;distribution:
</p>
<div class="math">$$P[\theta] = \frac{1}{Z} \prod_{\bm k} \exp \left[ - \frac{Ja^2}{T} (a_{\bm k}^2 + b_{\bm k}^2) \right]\,,$$</div>
<p>
which depends on the configurations of the field <span class="math">\(\theta_{\bm k}\)</span>.</p>
<p>We note that a gaussian random variable <span class="math">\(x\)</span>&nbsp;satisfies:
</p>
<div class="math">$$\braket{\E^{\I k x}} = \int_\mathbb{R} \D x \, \frac{\E^{-x^2/2\sigma^2}}{\sqrt{2\pi \sigma^2}} \E^{\I k x} = \E^{-\sigma^2 k^2/2} = \E^{- \braket{x^2} k^2/2}\,.$$</div>
<p>
Using this formula we rewrite the correlation function in a simpler&nbsp;form,
</p>
<div class="math">$$g(\bm x) = \exp \left[ \frac{1}{2} \braket{(\theta_{\bm x} - \theta_{\bm 0})^2} \right]\,.$$</div>
<p>
We must thus&nbsp;compute
</p>
<div class="math">\begin{align*}
  2 \ln g(\bm x) &amp;= \frac{1}{2} \braket{(\theta_{\bm x} - \theta_{\bm 0})^2} \\
  &amp;= \frac{1}{Z} \int \prod_{\bm k} \D a_{\bm k} \D b_{\bm k} \E^{-(Ja^2/T) \sum_{\bm k} k^2(a_{\bm k}^2 + b_{\bm k}^2)} (\theta_{\bm x} - \theta_{\bm 0})^2
\end{align*}</div>
<p>
where <span class="math">\(Z\)</span> is the partition function. The integral span all the degrees of freedom in fourier space (equal to the number of sites in the lattice <span class="math">\(N\)</span>). The last factor is readily transformed in fourier&nbsp;space:
</p>
<div class="math">$$(\theta_{\bm x} - \theta_0)^2 = \frac{1}{N} \sum_{\bm k_1} \sum_{\bm k_2} \big( \E^{\I \bm k_1 \cdot \bm x} - 1 \big) \big( \E^{\I \bm k_2 \cdot \bm x} - 1 \big) \theta_{\bm k_1} \theta_{\bm k_2} \,,$$</div>
<p>
we separate the diagonal terms <span class="math">\(\bm k_1 + \bm k_2 = 0\)</span>, 
</p>
<div class="math">$$\frac{2}{N} \sum_{\bm k} (1 - \cos \bm k \cdot \bm x) |\theta_{\bm k}|^2$$</div>
<p>
to&nbsp;obtain,
</p>
<div class="math">$$(\theta_{\bm x} - \theta_0)^2 = \frac{2}{N} \sum_{\bm k} (1 - \cos \bm k \cdot \bm x) (a_{\bm k}^2 + b_{\bm k}^2) + \sum (\bm k_1 + \bm k_2 \ne 0)$$</div>
<p>
where the second non diagonal term factorises into a product whose average vanishes because <span class="math">\(\braket{\theta_{\bm k}}=0\)</span> (the gaussian integral of an odd function is zero). 
The mean of each term in the sum is of the&nbsp;form,
</p>
<div class="math">$$\braket{a_{\bm k}^2 + b_{\bm k}^2} = \frac{1}{Z_{\bm k}} \int \D a_{\bm k} \D b_{\bm k} \, \E^{-(Ja^2/T) k^2 (a_{\bm k}^2 + b_{\bm k}^2)}\,(a_{\bm k}^2 + b_{\bm k}^2) = \frac{T}{Ja^2k^2}\,,$$</div>
<p>
where
</p>
<div class="math">$$Z_{\bm k} = \int \D a_{\bm k} \D b_{\bm k} \, \E^{-(Ja^2/T) k^2 (a_{\bm k}^2 + b_{\bm k}^2)}\,.$$</div>
<p>
Putting this result into the correlation function we&nbsp;obtain,
</p>
<div class="math">$$g(\bm x) = \exp \left[ \frac{T}{NJa^2} \sum_{\bm k} \frac{1 - \cos \bm k \cdot \bm x}{k^2} \right] \,.$$</div>
<p>
This expression is valid for small <span class="math">\(k\)</span>, therefore we can replace the sum by an&nbsp;integral
</p>
<div class="math">$$\frac{1}{N} \sum_{\bm k} \rightarrow \frac{a^2}{(2\pi)^2} \int \D \bm k\,.$$</div>
<p>
Using <span class="math">\(\bm k \cdot \bm x = kr \cos(\varphi)\)</span> and the definition of the zero order bessel&nbsp;function
</p>
<div class="math">$$\int_0^{2\pi} \D \varphi \cos(kr \cos \varphi) = 2\pi J_0(kr)\,,$$</div>
<p>
the sum is approximated, after integration over the polar angle <span class="math">\(\varphi\)</span>,&nbsp;by
</p>
<div class="math">$$\int_0^{\pi/a} \D k \frac{1- J_0(kr)}{k}\,.$$</div>
<p>
Note the upper value of the integral, where we introduced the cutoff <span class="math">\(\pi/a\)</span> which is the maximum value of the wavenumber compatible with the finite number of degrees of freedom (using the fact that at large distances <span class="math">\(r \gg a\)</span> the lattice is isotropic &#8212;as evidenced by the form of the spin wave hamiltonian which depends on the square of the gradient). The integral is then dominated by its value at the upper limit (it is regular at&nbsp;0):
</p>
<div class="math">$$\int_0^{\pi r/a} \D x \frac{1- J_0(x)}{x} \approx \ln(\pi r/a)\,.$$</div>
<p>
Therefore, we arrive at the final expression of the two spin correlation&nbsp;function:
</p>
<div class="math">$$g(r) \approx \left( \frac{\pi r}{a} \right)^{\eta(T)}\,, \; \eta = \frac{T}{2\pi J}\,.$$</div>
<p>
This is an important result. We observe that at low temperature the spin correlation function decreases algebraically. This slow decay is an indication of a kind of long range order, however, the characteristic exponent depends on the temperature. Before fully discussing this result, we should investigate the high temperature&nbsp;regime.</p>
<blockquote>
<p><img src="/images/PS-xy_1.svg" width="300"></p>
<p>Path between spins at <span class="math">\(\bm x\)</span> and <span class="math">\(\bm y\)</span> contributing to the high temperature correlation&nbsp;function.</p>
</blockquote>
<p>For <span class="math">\(T \gg J\)</span> the correlation (returning to the lattice&nbsp;notation)
</p>
<div class="math">\begin{align*}
  g(\bm r) &amp;= \braket{\cos(\theta_{\bm r} - \theta_{\bm 0})} \\
  &amp;= \frac{1}{Z} \int_0^{2\pi} \prod_{\bm x} \frac{\D \theta_{\bm x}}{2\pi} \cos(\theta_{\bm r} - \theta_{\bm 0}) \E^{(J/T) \sum_{\braket{\bm x, \bm y}} \cos(\theta_{\bm x} - \theta_{\bm y})}
\end{align*}</div>
<p>
or using <span class="math">\(J/T \ll 1\)</span> we expand the&nbsp;exponential
</p>
<div class="math">$$\E^{(J/T) \sum_{\braket{\bm x, \bm y}} \cos(\theta_{\bm x} - \theta_{\bm y})} \approx \prod_{\braket{\bm x, \bm y}} \left[1 + \frac{J}{T} \cos(\theta_{\bm x} - \theta_{\bm y}) +  \ldots \right]\,.$$</div>
<p>
We note, on the one hand, that any term with single bond&nbsp;vanishes,
</p>
<div class="math">$$\int_0^{2\pi} \frac{\D \theta_{\bm x}}{2\pi} \cos(\theta_{\bm x} - \theta_{\bm y}) = 0\,,$$</div>
<p>
on the other hand, two successive&nbsp;bonds
</p>
<div class="math">$$\int_0^{2\pi} \frac{\D \theta_{\bm x}}{2\pi} \cos(\theta_{\bm r} - \theta_{\bm x}) \cos(\theta_{\bm x} - \theta_{\bm 0})= \frac{1}{2} \cos(\theta_{\bm r} - \theta_{\bm 0})\,,$$</div>
<p>
The first condition leads to the conclusions that the only contribution to the correlation function are paths of bonds emanating from <span class="math">\(\bm 0\)</span> and reaching <span class="math">\(\bm r\)</span>:
</p>
<div class="math">$$g(0,r) = \mathrm{Re} \braket{\E^{\I \theta_0} \E^{-\I \theta_r}} =
\mathrm{Re} \braket{ \E^{\I \theta_0} \E^{-\I \theta_1} \E^{\I \theta_1} \E^{-\I \theta_2} \ldots \E^{\I \theta_{r-1}} \E^{-\I \theta_r} } \,,$$</div>
<p>
as represented in the figure. Analogously, the contribution of the end&nbsp;points
</p>
<div class="math">$$\int_0^{2\pi} \frac{\D \theta_{\bm r}\D \theta_{\bm 0}}{2\pi} \cos(\theta_{\bm r} - \theta_{\bm 0})^2 = \frac{1}{2}\,.$$</div>
<p>
Each intermediate term of the path contributes a factor <span class="math">\(J/2T\)</span> (corresponding to the second integral). Therefore, at high temperature the dominant contribution comes from the shortest path, the one with the smaller number of <span class="math">\(J/\)</span>&nbsp;factors:
</p>
<div class="math">$$g(r) \approx \left( \frac{J}{2T} \right)^{r/a}$$</div>
<p>
because <span class="math">\(r/a\)</span> is the number of links in the path between <span class="math">\(\bm 0\)</span> and <span class="math">\(\bm r\)</span>. We finally obtained that at high temperature the correlations decay exponentially fast; the characteristic length depends on the&nbsp;temperature,
</p>
<div class="math">$$g(r) \approx \E^{-r/\xi(T)},\quad \xi(T) \approx \frac{a}{\ln(2T/J)}\,.$$</div>
<p>Then, gathering the high and low temperature results together, the following picture arises. The system is disordered at high temperature, in the same way of a paramagnetic material; at low temperature it shows a <em>critical</em> behavior characterized by algebraically decaying correlations. The mean of a critical state is related to the absence of characteristic length; one may find patches of aligned rotators at all scales, like in the critical region (around a phase transition) of the ising model, as we observed in the monte carlo simulations (previous&nbsp;section).</p>
<p>A question naturally arises about the mechanism driving the transition between these two qualitatively distinct physical regimes. Kosterlitz and Thouless<sup id="fnref:kt"><a class="footnote-ref" href="#fn:kt">5</a></sup> demonstrated that it is the unbinding of <em>vortices,</em> a particular kind of excitations different to the spin waves prevailing at low temperature. The idea is that in addition to spin waves other, finite energy excitations can exists. Vortices are topologically nontrivial configurations of a vector field, textures that cannot be continuously deformed into a, say, constant field. In two dimensions the simplest vortex configuration is (in the continuous&nbsp;approximation),
</p>
<div class="math">$$\bm v = \nabla \theta(\bm x) = q \frac{\hat{\theta}}{r}\,,$$</div>
<p>
which, as a consequence of the angle periodicity, the circulation&nbsp;satisfies,
</p>
<div class="math">$$\oint_\mathcal{C} \D \bm l \cdot \nabla \theta(\bm r) = 2 \pi q, \quad q \in \mathbb{Z}$$</div>
<p>
implying that <span class="math">\(q\)</span> must be an integer, and is called the vortex <em>charge</em> (correspondign to the topological charge or, in the present case, the field <span class="math">\(\bm v\)</span> winding number); the closed path in the plane <span class="math">\(\mathcal{C}\)</span> is arbitrary. The discrete version of the previous integral&nbsp;is,
</p>
<div class="math">$$\sum_{\bm x, \bm y \in \mathcal{C}} (\theta_{\bm x} - \theta_{\bm y} \mod \, \pm \pi) = 2\pi q\,.$$</div>
<p>The energy of a vortex of charge <span class="math">\(q\)</span>&nbsp;is
</p>
<div class="math">$$E_v = \frac{J}{2} \int \D \bm x |\nabla \theta|^2 = \pi J q^2 \int_a^L r\D r \frac{1}{r^2},$$</div>
<p>
or
</p>
<div class="math">$$E_v = \pi J q^2 \ln \frac{L}{a}\,,$$</div>
<p>
and we introduced the short and long lengths cutoffs, the lattice step <span class="math">\(a\)</span>, and the system&#8217;s size <span class="math">\(L\)</span>, respectively. The corresponding entropy can be estimated form the number of configurations one vortex can take in a system of size <span class="math">\(L^2\)</span>; taking into account that the vortex core occupies one plaquette of size <span class="math">\(a^2\)</span>, the number of configuration is <span class="math">\(L^2/a^2\)</span>:
</p>
<div class="math">$$S_v = \ln (L/a)^2.$$</div>
<p>
The free energy of a vortex&nbsp;is,
</p>
<div class="math">$$F_v = (\pi J - 2T) \ln \frac{L}{a}\,.$$</div>
<p>
Therefore, we have vortex excitations that, as a result of the logarithmic energy and entropy increase with the system&#8217;s size, their free energy change sign at a critical&nbsp;temperature
</p>
<div class="math">$$T_{KT} = \frac{J\pi}{2}\,;$$</div>
<p>
above the Kosterlitz-Thouless temperature <span class="math">\(T &gt; T_{KT}\)</span>, the <em>one</em> vortex free energy is negative, meaning that increasing the number of vortices we can lower <span class="math">\(F\)</span>; under <span class="math">\(T_{KT}\)</span> (<span class="math">\(T&lt; T_{KT}\)</span>), the free energy is positive and vortices become thermodynamically unfavorable. Thus, <span class="math">\(T_{KT}\)</span> separates a low temperature phase in which there are not free vortices (in fact vortices are bounded in pairs), and a high temperature phase dominated by free&nbsp;vortices.</p>
<blockquote>
<p><img src="/images/PS-xy_e.png" width="350"></p>
<p>Experimental measure of the superfluid mass per unit area <span class="math">\(\rho_s\)</span> as a function of the critical temperature: the Kosterlitz-Thouless theory predicts a universal constant, given by the slope of the straight line (equivalent to the relation <span class="math">\(T_{KT}/J = \pi/2\)</span> in the <span class="caps">XY</span> model); by Bishop and Reppy, <em>Study of the Superfluid Transition in Two-Dimensional <span class="math">\(^{4}\mathrm{He}\)</span> Films</em>, Phys. Rev. Lett. <strong>40</strong>, 1727 (1978) Â©1978 American Physical&nbsp;Society.</p>
</blockquote>
<p>The fact that at low temperature vortices are bounded results form their finite interaction energy <strong style="color:DarkSlateBlue; background-color:LightGray;"><span class="caps">EX</span></strong>:<sup id="fnref2:xy"><a class="footnote-ref" href="#fn:xy">4</a></sup>
</p>
<div class="math">$$E_{vv} = -\pi J q_1 q_2 \ln \frac{|\bm x - \bm y|}{a}$$</div>
<p>
where <span class="math">\(q_1\)</span> and <span class="math">\(q_2\)</span> are their charges, and <span class="math">\(|\bm x - \bm y|\)</span> is their separation. Therefore, lowering the temperature free vortices tend to form pairs with other vortices (note that the total vortex charge must&nbsp;vanish).</p>
<blockquote>
<p><img src="/images/PS-xy_v.svg" width="300"></p>
<p>Snapshot of the <span class="caps">XY</span> rotators at a temperature above the transition temperature <span class="math">\(T_{KT}\)</span>, showing many pairs of vortices (<span class="math">\(q=1\)</span> in red <span class="math">\(+\)</span>, and <span class="math">\(q=-1\)</span> in blue <span class="math">\(\times\)</span>), and some isolated vortices (gray circles). Only a lattice sector <span class="math">\(16 \times 16\)</span> is&nbsp;shown.</p>
</blockquote>
<p>The high and low temperature expansions showed that the <span class="caps">XY</span> model, even if it lacks of an ordered ferromagnetic-like phase, exhibit a kind of long range order below some critical temperature; however, the precise description of the transition, viewed as the unbinding of vortex (topological) excitations, needs an account of the vortex interaction. The vortices can be seen as a gas of charged particles interacting through a coulomb potential, proportional to the logarithm of the distance between two charges in two dimensions; the collective action of this potential is to screen a test charge (as in a real plasma), modifying the &#8220;dielectric&#8221; properties of the medium. Kosterlitz and Thouless, using the model of a two dimensional coulomb gas, derived the critical properties of the <span class="caps">XY</span> model. Within this analogy the transition appears as the transition between an isolating state, in which the charges (vortices) are bounded, to a metal state in which they are free. The method to investigate the critical behavior in interacting systems is the <em>renormalization group</em>. It allows the investigation of the influence of the short scales, of the order of the lattice spacing <span class="math">\(a\)</span>: a change in <span class="math">\(a\)</span> renormalize the effective interaction of the vortices <span class="math">\(J\)</span>. Beyond the spin wave approximation, the effect of the interactions can be encoded in an effective scale dependent coupling parameter <span class="math">\(J \rightarrow J(a)\)</span>. This can be illustrated by considering the partition function of a single vortex (we put <span class="math">\(q=1\)</span>),
</p>
<div class="math">$$Z_{v} = \left(\frac{L}{a}\right)^2 \E^{-\epsilon_0(a)/T - \pi (J/T) \ln (L/a)}$$</div>
<p>
where <span class="math">\(\epsilon_0(a)\)</span> is the vortex selfenergy (the energy necessary to create a vortex). If we change <span class="math">\(a\)</span> into <span class="math">\(ba\)</span> (<span class="math">\(b\)</span> is then a scale factor) and impose that the partition function <em>do not change</em> we get <strong style="color:DarkSlateBlue; background-color:LightGray;"><span class="caps">EX</span></strong>,
</p>
<div class="math">$$y_0(ba) = y_0(a) b^{2 - \pi J/T},\quad y_0(a) = \E^{-\epsilon_0(a)/T} \,,$$</div>
<p> 
showing that a change of scale modifies the vortex core energy, and thus their effective interaction, which becomes scale dependent <span class="math">\(J \rightarrow J(b)\)</span>, as anticipated before. The <em>invariance</em> of the thermodynamic properties, which cannot depend on the scale factor, leads to a set of renormalization equations for the parameters <span class="math">\(y_0(b)\)</span> and <span class="math">\(J(b)\)</span>. Finding the fixed point of these equation (a further change of scale, do not change the solution) leads to explicit expressions of the critical temperature (correcting the previous estimation using the one vortex free&nbsp;energy)
</p>
<div class="math">$$ \frac{\pi J}{2T_{KT}} -1 = 2\pi \E^{-\pi^2 J / 2T_{KT}}\,,$$</div>
<p>
giving a critical temperature below the bare value <span class="math">\(\pi/2\)</span>, the correlation&nbsp;length,
</p>
<div class="math">$$\xi = a \exp \left( \frac{\pi^2}{8c\sqrt{T-T_{KT}}} \right)\,,$$</div>
<p>
and free energy in the critical&nbsp;region:
</p>
<div class="math">$$f \sim \xi^{-2} \sim \exp \left( -\frac{\pi^2}{4c\sqrt{T-T_{KT}}} \right)\,,$$</div>
<p>
where <span class="math">\(c\)</span> is a numerical constant (<span class="math">\(c\approx 1.5\)</span>). Therefore, the free energy has an essential singularity at the transition point, leading to continuous thermodynamic quantities (its derivatives are continuous functions of the temperature across the transition); in this sense we can say that the Kosterlitz-Thouless transition is of infinite&nbsp;order.</p>
<h3>Notes</h3>
<div class="footnote">
<hr>
<ol>
<li id="fn:BS">
<p>BarabÃ¡si, A. L., and Stanley, H. E., <em>Fractal Concepts in Surface Growth,</em> (Cambridge, 1995)&#160;<a class="footnote-backref" href="#fnref:BS" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:BV">
<p>Barrat, A., BarthÃ©lemy, M., and Vespignani, A., <em>Dynamical Processes in Complex Networks,</em> (Cambridge, 2008)&#160;<a class="footnote-backref" href="#fnref:BV" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:KR">
<p>Krapivsky, P., Redner, S., and Ben-Naim, E., <em>A Kinetic View of Statistical Physics,</em> (Cambridge, 2010)&#160;<a class="footnote-backref" href="#fnref:KR" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:xy">
<p>Plischke, M., and Bersen, B., <em>Equilibrium Statistical Physics,</em> (Word Scientific,&nbsp;2006)</p>
<p>A more complete presentation of the <span class="caps">XY</span> model can be found&nbsp;in:</p>
<ul>
<li>Chaikin, P. M., and Lubensky, T.C., <em>Principles of Condensed Matter Physics,</em> (Cambridge,&nbsp;2000)</li>
<li>Kardar, M., <em>Statistical Physics of Fields,</em> (Cambridge,&nbsp;2007)</li>
</ul>
<p><a class="footnote-backref" href="#fnref:xy" title="Jump back to footnote 4 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:xy" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:kt">
<p>Kosterlitz, J. M., and Thouless, D. J., <em>Ordering, metastability and phase transitions in two-dimensional systems,</em> J. Phys. C <strong>6</strong>, 1181 (1973) <a href="/pdfs/Kosterlitz-2016nl.pdf">.pdf</a>&#160;<a class="footnote-backref" href="#fnref:kt" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
</ol>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "true";

    if (true) {
        align = (screen.width < 700) ? "left" : align;
        indent = (screen.width < 700) ? "0em" : indent;
        linebreak = (screen.width < 700) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>
</article>
      </div>
    </div>

    <footer class="footer">
      <div class="container">
        <div class="row">
          <ul class="col-sm-6 list-inline">
            <li class="list-inline-item"><a href="/archives.html">Archives</a></li>
              <li class="list-inline-item"><a href="/tags.html">Tags</a></li>
            <li>&#xa9;Alberto&nbsp;Verga&nbsp;(2024)</li>
          </ul>
          <p class="col-sm-6 text-sm-right text-muted">
          <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a> / <a href="https://getbootstrap.com" target="_blank"><img alt="Bootstrap" src="/theme/css/bootstrap-solid.svg" style="height: 18px;"/></a> / <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License Non-Commercial 4.0" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a> CC 4.0
          </p>
        </div>
      </div>
    </footer>
  </body>

</html>