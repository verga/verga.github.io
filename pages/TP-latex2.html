<!DOCTYPE html>
<html lang="en">

  <head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>LaTeX recipes: graphics | Random physics
</title>
    <link rel="canonical" href="/pages/TP-latex2.html">

    <link rel="stylesheet" href="/theme/css/bootstrapr.min.css">
    <link rel="stylesheet" href="/theme/css/font-awesome.min.css">
    <link rel="stylesheet" href="/theme/css/pygments/autumn.min.css">
    <link rel="stylesheet" href="/theme/css/style.css">

    <link rel="icon" type="image/png" href="/extras/rphys.png" sizes="64x64">

<meta name="description" content="A practical introduction to the numerical tools for scientific writing: graphics">

  </head>

  <body>
    <header class="header">
      <div class="container">
        <div class="row">
          <div class="col-sm-12">
            <h1 class="title"><a href="/">Random physics</a></h1>
            <p class="text-muted">Alberto Verga, research notebook</p>
              <ul class="list-inline">
                  <li class="list-inline-item"><a href="/">Blog</a></li>
                      <li class="list-inline-item text-muted">|</li>
                      <li class="list-inline-item"><a href="/pages/about.html">About</a></li>
                      <li class="list-inline-item"><a href="/pages/lectures.html">Lectures</a></li>
              </ul>
          </div>
        </div>
      </div>
    </header>

    <div class="main">
      <div class="container">

<article class="article">
  <div class="content">
    <p><span class="math">\(\newcommand{\I}{\mathrm{i}} 
\newcommand{\E}{\mathrm{e}} 
\newcommand{\D}{\mathop{}\!\mathrm{d}}
\newcommand{\bra}[1]{\langle{#1}|}
\newcommand{\ket}[1]{|{#1}\rangle}&nbsp;\newcommand{\braket}[1]{\langle{#1}\rangle}\)</span></p>
<blockquote>
<p><a href="/pages/ON-index.html">Workshop</a> on scientific&nbsp;typesetting.</p>
</blockquote>
<h1>Graphics&nbsp;tools</h1>
<p>You may find a large choice of <a href="https://pyviz.org/">graphic python libraries</a>:</p>
<ul>
<li><code>matplotlib</code> is the basic package to plot functions in 1D and 2D, basic histograms, contour and density plots, including text tools (you may use latex for the labels). See the <a href="https://matplotlib.org/gallery/index.html">gallery of examples</a>. It can be associated with other libraries such <a href="https://pandas.pydata.org/"><code>pandas</code></a> for data analysis, or <a href="https://networkx.github.io/"><code>networkx</code></a> for graph&nbsp;theory.</li>
<li><a href="http://holoviews.org/"><code>holoviews</code></a> which aggregates many graphic tools and allow for interacting pictures integrated in <a href="https://jupyter.org/"><code>jupiter notebooks</code></a>.</li>
</ul>
<p>There are also graphic libraries oriented to be used in <span class="math">\(\TeX\)</span>&nbsp;documents:</p>
<ul>
<li><a href="http://www.texample.net/tikz/examples/"><code>TikZ</code></a> is the best solution to insert figures directly using the text source; it has a large variety of libraries to be used in various domains, as for instance elementary geometry, graph theory, networks or quantum circuits, see the <a href="http://www.texample.net/tikz/examples/">gallery</a>.</li>
<li><a href="http://asymptote.sourceforge.net/"><code>Asymptote</code></a> a sophisticated graphic language, which includes 3D&nbsp;tools.</li>
</ul>
<p>The python libraries are included in the <a href="https://www.anaconda.com/distribution/">anaconda distribution</a>. The <span class="math">\(\TeX\)</span> tools are included in the TeX Live distribution, you do not need to install&nbsp;them.</p>
<h2>Matplotlib&nbsp;example</h2>
<p>The Lennard Jones potential depends on two parameters, the hard core length <span class="math">\(r_0\)</span> and the binding energy <span class="math">\(\epsilon\)</span>:</p>
<div class="math">$$ w(r) = 4\epsilon \left[ \left(\frac{r_0}{r}\right)^{12} - \left(\frac{r_0}{r}\right)^{6}   \right]$$</div>
<p><Paste></p>
<div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span> <span class="c1"># x-points</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">12</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># LJ</span>
<span class="c1"># plot</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">2.7</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;0.35&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.4</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;0.35&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;0.35&#39;</span><span class="p">)</span>
<span class="c1"># labels and text</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r/r_0$&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$w(r)/\epsilon$&#39;</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span><span class="mf">0.13</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$r_0$&quot;</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$-\epsilon$&quot;</span><span class="p">)</span>
<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;lj.pdf&#39;</span><span class="p">)</span> <span class="c1"># save figure in pdf format</span>
</code></pre></div>

<blockquote>
<p><img src="/images/TP-lj.svg" style="width:250px;"\img></p>
</blockquote>
<p>Note that it is possible to embed python code directly in the tex source file using the package <a href="https://github.com/gpoore/pythontex"><code>pythontex</code></a> (included in the texlive&nbsp;distribution).</p>
<p>In order to obtain compatible styles between matplotlib graphics and latex text, you may create a matplotlib style&nbsp;file:</p>
<div class="highlight"><pre><span></span><code><span class="n">lines</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mf">1.0</span>
<span class="n">text</span><span class="o">.</span><span class="n">usetex</span> <span class="p">:</span> <span class="kc">True</span>
<span class="n">font</span><span class="o">.</span><span class="n">family</span> <span class="p">:</span> <span class="n">serif</span>
<span class="n">font</span><span class="o">.</span><span class="n">weight</span> <span class="p">:</span> <span class="n">normal</span>
<span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="p">:</span> <span class="mf">20.0</span>
<span class="n">font</span><span class="o">.</span><span class="n">serif</span> <span class="p">:</span> <span class="n">STIX</span> <span class="n">Two</span> <span class="n">Text</span><span class="p">,</span> <span class="n">DejaVu</span> <span class="n">Serif</span><span class="p">,</span> <span class="n">Computer</span> <span class="n">Modern</span> <span class="n">Roman</span><span class="p">,</span> <span class="n">serif</span>
<span class="n">mathtext</span><span class="o">.</span><span class="n">fontset</span> <span class="p">:</span> <span class="n">stix</span>
<span class="n">mathtext</span><span class="o">.</span><span class="n">rm</span> <span class="p">:</span> <span class="n">serif</span>
<span class="n">axes</span><span class="o">.</span><span class="n">titlesize</span> <span class="p">:</span> <span class="mi">24</span>
<span class="n">axes</span><span class="o">.</span><span class="n">labelsize</span> <span class="p">:</span> <span class="mi">24</span>
<span class="n">xtick</span><span class="o">.</span><span class="n">top</span> <span class="p">:</span> <span class="kc">True</span>
<span class="n">ytick</span><span class="o">.</span><span class="n">right</span> <span class="p">:</span> <span class="kc">True</span>
<span class="n">xtick</span><span class="o">.</span><span class="n">direction</span> <span class="p">:</span> <span class="n">out</span>
<span class="n">ytick</span><span class="o">.</span><span class="n">direction</span> <span class="p">:</span> <span class="n">out</span>
<span class="n">figure</span><span class="o">.</span><span class="n">figsize</span> <span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">4.5</span>
<span class="n">savefig</span><span class="o">.</span><span class="n">bbox</span> <span class="p">:</span> <span class="n">tight</span>
<span class="n">savefig</span><span class="o">.</span><span class="n">dpi</span> <span class="p">:</span> <span class="mi">300</span>
</code></pre></div>

<p>where we use <span class="math">\(\LaTeX\)</span> for the figure labels, define the figure size <span class="math">\(6\times 4.5\)</span> (aspect ratio 4:3), and suitable font sizes. For the fonts we use <code>stix</code>. However, the standard choice, available in every operating system, is Computer Modern Roman (serif) and cm (math fonts). This file must be created inside the <code>.config/matplotlib/stylelib</code> folder and have the extension <code>.mplstyle</code>; it is invoked within python with <code>plt.style.use('name')</code>, if your file name is <code>name.mplstyle</code>.</p>
<h2>TikZ ist kein&nbsp;Zeichenprogramm</h2>
<p><a href="https://mirrors.chevalier.io/CTAN/graphics/pgf/base/doc/pgfmanual.pdf">TikZ</a> and <a href="https://mirrors.chevalier.io/CTAN/graphics/pgf/contrib/pgfplots/doc/pgfplots.pdf">pgfplots</a> are popular graphics packages. Tikz is specially useful for schematic drawing, diagrams, graphs with nodes and links, geometry, and in general it is perfect to illustrate mathematical and physical concepts. At variance, pgfplots needs often external programs (like gnuplot) and can be replaced by standard graphical programming libraries (matplotlib is an&nbsp;example).</p>
<p><strong>tikz</strong>. The package is loaded with <code>\usepackage{tikz}</code> you may also need to load specialized libraries like: <code>\usetikzlibrary{calc,positioning,scopes,shapes}</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">\documentclass</span><span class="nb">{</span>article<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>tikz<span class="nb">}</span>
<span class="k">\usetikzlibrary</span><span class="nb">{</span>calc,positioning,scopes,shapes<span class="nb">}</span>
...
<span class="c">%</span>
<span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>
...
<span class="k">\begin</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
   ...
<span class="k">\end</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
...
<span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</code></pre></div>

<p><strong>tikzpicture</strong>. The picture environment, where you put your tikz code, is <code>tikzpicture</code>. You may choose many options, for instance <code>scale=2</code> or <code>node distance=5mm</code>, etc. The style of the pictures can be globally defined by <code>\tikzset{every picture/.style={line width=2pt, color=red!80}}</code>; if instead of <code>every picture</code>, which is pre-defined, you use a name, this name is globally available; styles can also be defined as option of tikzpicture; options can also be defined inside the tikzpicture using the <code>scope</code> environment; a convenient way to use <code>scope</code> is to load the <code>scopes</code> library.</p>
<p><strong>path</strong>. The drawing commands are <code>\path</code>, <code>\draw</code>, <code>\fill</code> and <code>\clip</code>. Path and clip do not draw anything by themselves, but for example <code>\path[draw]</code> is equivalent to <code>\draw</code>. A path is basically a sequence of coordinates; the linking operator can be <code>--</code> (segment) or <code>..</code> (curve).</p>
<p>Coordinates can be given as an ordered pair <span class="math">\((x,y)\)</span> (canvas) or <span class="math">\((\phi:r)\)</span> (canvas polar), or by name <code>(node name)</code>; relative coordinates with respect to the current position are given bi <span class="math">\(+(,)\)</span> (without update) or <span class="math">\(++(,)\)</span> (with position&nbsp;update):</p>
<ul>
<li>
<p>to draw a rectangle: <code>\path[draw] (0,0)--(0,1)--(1,1)--(1,0)--cycle</code> (&#8216;cycles&#8217; ensures a closed path), or a shifted one <code>\draw (1,3) -- +(0,1) -- +(1,1) -- +(1,0) --cycle</code>, or equivalently <code>\draw (1,3) -- ++(0,1) -- ++(1,0) -- ++(0,-1) --cycle</code></p>
<p><img alt="tikz" src="/images/TP-r.svg"></p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">\begin</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
<span class="k">\path</span><span class="na">[draw]</span> (0,0)--(0,1)--(1,1)--(1,0)--cycle;
<span class="k">\draw</span><span class="na">[fill=blue!60]</span> (1,1.2) -- +(0,1) -- +(1,1) -- +(1,0) --cycle;
<span class="k">\draw</span><span class="na">[fill=red!60]</span> (1,-1.2) -- ++(0,1) -- ++(1,0) -- ++(0,-1) --cycle;
<span class="k">\end</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
</code></pre></div>

<p><strong>node</strong>. It is the tikz basic construction. It can be specified by <code>\node['options'] ('name') at 'coordinate' {'label'}</code>, or as a part of a&nbsp;path:</p>
<p><code>\path (0,0) node {A} (1,0) node {B} (1,1) node {C} (1,-1) node {D};</code> </p>
<p><img alt="tikz" src="/images/TP-n.svg"></p>
<p>A more complicate example, using fine&nbsp;positioning:</p>
<div class="highlight"><pre><span></span><code><span class="k">\begin</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>[
  every node/.style=<span class="nb">{</span>draw, minimum size=1cm, fill=gray!25, rounded corners<span class="nb">}</span>,
  ]
<span class="k">\node</span><span class="na">[minimum width=5cm]</span> (M) <span class="nb">{</span><span class="s">$</span><span class="nb">M</span><span class="s">$</span><span class="nb">}</span>;
<span class="k">\node</span><span class="na">[above=of M.north west, anchor=south west]</span> (A) <span class="nb">{</span><span class="s">$</span><span class="nb">a</span><span class="s">$</span><span class="nb">}</span>;
<span class="k">\node</span><span class="na">[above=of M]</span> (B) <span class="nb">{</span><span class="s">$</span><span class="nb">b</span><span class="s">$</span><span class="nb">}</span>;
<span class="k">\node</span><span class="na">[above=of M.north east, anchor=south east]</span> (C) <span class="nb">{</span><span class="s">$</span><span class="nb">c</span><span class="s">$</span><span class="nb">}</span>;
<span class="k">\draw</span><span class="na">[-&gt;]</span> (M.north -| A) -- (A);
<span class="k">\draw</span><span class="na">[-&gt;]</span> (M) -- (B);
<span class="k">\draw</span><span class="na">[-&gt;]</span> (M.north -| C) -- (C);
<span class="k">\draw</span><span class="na">[-]</span> (M.west) -- +(-1,0);
<span class="k">\draw</span><span class="na">[-]</span> (M.east) -- +(1,0);
<span class="k">\end</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
</code></pre></div>

<p><img alt="tikz" src="/images/TP-nn.svg"></p>
<p>Observe the relative positions in this case: <img alt="tikz" src="/images/TP-rel.svg"></p>
<div class="highlight"><pre><span></span><code><span class="k">\begin</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
  <span class="k">\fill</span><span class="na">[gray!50]</span> (0,0) circle (2pt)
    node[anchor=south,black] <span class="nb">{</span><span class="s">$</span><span class="nb">S</span><span class="s">$</span><span class="nb">}</span> 
    node[anchor=north] <span class="nb">{</span><span class="s">$</span><span class="nb">N</span><span class="s">$</span><span class="nb">}</span> 
    node[anchor=east] <span class="nb">{</span><span class="s">$</span><span class="nb">E</span><span class="s">$</span><span class="nb">}</span> 
    node[anchor=west] <span class="nb">{</span><span class="s">$</span><span class="nb">W</span><span class="s">$</span><span class="nb">}</span>;
<span class="k">\end</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
</code></pre></div>

<p>You see that the dot (filled circle), which is the drawn <em>object</em>, is located to the south of the node labeled <span class="math">\(S\)</span>, the node is then anchored to the north of the object, and similarly for the other&nbsp;nodes.</p>
<p>Some node options are: shape (rectangle, circle, etc.), anchor (above, below, left, right, etc.), <code>every node/.style={...}</code>, inner sep, outer sep (separation), minimum height, minimum width, and many&nbsp;others!</p>
<p>Nodes can be used as &#8216;coordinates&#8217;, this is useful to connect them by paths and&nbsp;edges:</p>
<div class="highlight"><pre><span></span><code><span class="k">\begin</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
  <span class="k">\path</span> (-1,0) node[circle,draw] (a) <span class="nb">{</span><span class="s">$</span><span class="nv">\uparrow</span><span class="s">$</span><span class="nb">}</span>
        (0,1) node[circle,draw] (b) <span class="nb">{</span><span class="s">$</span><span class="nv">\downarrow</span><span class="s">$</span><span class="nb">}</span>
        (1,0) node[rectangle,draw,red!80!black] (c) <span class="nb">{</span><span class="s">$</span><span class="nv">\uparrow</span><span class="s">$</span><span class="nb">}</span>;

      <span class="k">\path</span><span class="na">[&lt;-&gt;]</span> (a) edge node[above left] <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="nb">J</span><span class="s">$</span><span class="nb">}</span> (b)
            edge[red!50!black] node[below] <span class="nb">{</span><span class="s">$</span><span class="o">+</span><span class="nb">J</span><span class="s">$</span><span class="nb">}</span> (c)
        (b) edge node[above right] <span class="nb">{</span><span class="s">$</span><span class="o">-</span><span class="nb">J</span><span class="s">$</span><span class="nb">}</span> (c);
<span class="k">\end</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
</code></pre></div>

<p><code>edge</code> inherits the options form the surrounding path <img alt="tikz" src="/images/TP-f.svg"></p>
<p>A sequence of similar path commands can be obtained using the <strong>foreach</strong> operation, <code>\path ... foreach 'variables' ['options'] in {'path commands'} ... ;</code></p>
<div class="highlight"><pre><span></span><code><span class="k">\begin</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
  <span class="k">\foreach</span> <span class="k">\x</span> in <span class="nb">{</span>0,1,2,3<span class="nb">}</span>
    <span class="k">\draw</span> (<span class="k">\x</span>,0) -- (<span class="k">\x</span>,3);
  <span class="k">\foreach</span> <span class="k">\y</span> in <span class="nb">{</span>0,1,2,3<span class="nb">}</span>
    <span class="k">\draw</span> (0,<span class="k">\y</span>) -- (3,<span class="k">\y</span>);
  <span class="k">\foreach</span> <span class="k">\x</span> in <span class="nb">{</span>0,1,2,3<span class="nb">}</span>
    <span class="k">\foreach</span> <span class="k">\y</span> in <span class="nb">{</span>0,1,2,3<span class="nb">}</span>
      <span class="k">\path</span> (<span class="k">\x</span>,<span class="k">\y</span>) node[circle, fill=gray!20, 
                       rotate=180*(0.5*rand+1), 
                       draw] <span class="nb">{</span><span class="s">$</span><span class="nv">\rightarrow</span><span class="s">$</span><span class="nb">}</span> ;
<span class="k">\end</span><span class="nb">{</span>tikzpicture<span class="nb">}</span>
</code></pre></div>

<p><img alt="tikz" src="/images/TP-s.svg"></p>
<p>where we used <code>rand</code> for a random orientation of the node&nbsp;arrows.</p>
<h3>Example: quantum&nbsp;circuit</h3>
<p>The following circuit describes the Deutsch algorithm, which allows determining if the boolean function is balanced, using a single evaluation of <span class="math">\(f(x)\)</span>. We use the package <a href="https://arxiv.org/abs/1809.03842"><code>quantikz</code> by Alastair Kay</a>:</p>
<div class="highlight"><pre><span></span><code><span class="k">\documentclass</span><span class="nb">{</span>standalone<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>tikz<span class="nb">}</span>
<span class="k">\usetikzlibrary</span><span class="nb">{</span>external,quantikz<span class="nb">}</span>
<span class="k">\tikzexternalize</span> <span class="c">% create pdf of figures with the</span>
                 <span class="c">% external library </span>
                 <span class="c">% compile with the -shell-escape option</span>
<span class="c">%</span>
<span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>
<span class="k">\tikzset</span><span class="nb">{</span> slice/.append style=<span class="nb">{</span>gray<span class="nb">}}</span>
<span class="k">\begin</span><span class="nb">{</span>quantikz<span class="nb">}</span>
<span class="k">\lstick</span><span class="nb">{</span><span class="s">$</span><span class="nv">\ket</span><span class="nb">{</span><span class="m">0</span><span class="nb">}^{</span><span class="nv">\otimes</span><span class="nb"> n}</span><span class="s">$</span><span class="nb">}</span> <span class="nb">&amp;</span> 
<span class="k">\gate</span><span class="nb">{</span>H<span class="nb">^{</span><span class="k">\otimes</span> n<span class="nb">}}</span> <span class="k">\slice</span><span class="nb">{</span><span class="s">$</span><span class="nv">\ket</span><span class="nb">{</span><span class="nv">\psi</span><span class="nb">_</span><span class="m">1</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span> <span class="nb">&amp;</span>
  <span class="k">\ctrl</span><span class="nb">{</span>1<span class="nb">}</span> <span class="k">\slice</span><span class="nb">{</span><span class="s">$</span><span class="nv">\ket</span><span class="nb">{</span><span class="nv">\psi</span><span class="nb">_</span><span class="m">2</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span> <span class="nb">&amp;</span> 
  <span class="k">\gate</span><span class="nb">{</span>H<span class="nb">^{</span><span class="k">\otimes</span> n<span class="nb">}}</span> <span class="k">\slice</span><span class="nb">{</span><span class="s">$</span><span class="nv">\ket</span><span class="nb">{</span><span class="nv">\psi</span><span class="nb">_</span><span class="m">3</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span> <span class="nb">&amp;</span>
  <span class="k">\qw\\</span>
<span class="k">\lstick</span><span class="nb">{</span><span class="s">$</span><span class="nv">\ket</span><span class="nb">{</span><span class="m">1</span><span class="nb">}</span><span class="s">$</span><span class="nb">}</span> <span class="nb">&amp;</span>
  <span class="k">\gate</span><span class="nb">{</span>H<span class="nb">}</span> <span class="nb">&amp;</span>
  <span class="k">\gate</span><span class="nb">{</span>y <span class="k">\otimes</span> f(x)<span class="nb">}</span> <span class="nb">&amp;</span>
  <span class="k">\qw</span> <span class="nb">&amp;</span>
  <span class="k">\qw</span>
<span class="k">\end</span><span class="nb">{</span>quantikz<span class="nb">}</span>
<span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</code></pre></div>

<p><img alt="tikz" src="/images/TP-c.svg"></p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "true";

    if (true) {
        align = (screen.width < 700) ? "left" : align;
        indent = (screen.width < 700) ? "0em" : indent;
        linebreak = (screen.width < 700) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>
</article>
      </div>
    </div>

    <footer class="footer">
      <div class="container">
        <div class="row">
          <ul class="col-sm-6 list-inline">
            <li class="list-inline-item"><a href="/archives.html">Archives</a></li>
            <li class="list-inline-item"><a href="/categories.html">Categories</a></li>
              <li class="list-inline-item"><a href="/tags.html">Tags</a></li>
          </ul>
          <p class="col-sm-6 text-sm-right text-muted">
          <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a> / <a href="https://getbootstrap.com" target="_blank"><img alt="Bootstrap" src="/theme/css/bootstrap-solid.svg" style="height: 18px;"/></a> / <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License Non-Commercial 4.0" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a> CC 4.0
          </p>
        </div>
      </div>
    </footer>
  </body>

</html>