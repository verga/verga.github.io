<!DOCTYPE html>
<html lang="en">

  <head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Hamilton formalism | Random physics
</title>
    <link rel="canonical" href="/pages/hamilton.html">

    <link rel="stylesheet" href="/theme/css/bootstrapr.min.css">
    <link rel="stylesheet" href="/theme/css/font-awesome.min.css">
    <link rel="stylesheet" href="/theme/css/pygments/autumn.min.css">
    <link rel="stylesheet" href="/theme/css/style.css">

    <link rel="icon" type="image/png" href="/extras/rphys.png" sizes="64x64">

<meta name="description" content="Hamiltonian systems and phase space description of the dynamics; Poincaré maps; nonlinear resonance and standard map.">

  </head>

  <body>
    <header class="header">
      <div class="container">
        <div class="row">
          <div class="col-sm-12">
            <h1 class="title"><a href="/">Random physics</a></h1>
            <p class="text-muted">Alberto Verga, research notebook</p>
              <ul class="list-inline">
                  <li class="list-inline-item"><a href="/">Blog</a></li>
                      <li class="list-inline-item text-muted">|</li>
                      <li class="list-inline-item"><a href="/pages/about.html">About</a></li>
                      <li class="list-inline-item"><a href="/pages/lectures.html">Lectures</a></li>
              </ul>
          </div>
        </div>
      </div>
    </header>

    <div class="main">
      <div class="container">

<article class="article">
  <div class="content">
    <p><span class="math">\(\newcommand{\I}{\mathrm{i}} 
\newcommand{\E}{\mathrm{e}} 
\newcommand{\D}{\mathop{}\!\mathrm{d}} 
\newcommand{\Di}[1]{\mathop{}\!\mathrm{d}#1\,}&nbsp;\newcommand{\Dd}[1]{\frac{\mathop{}\!\mathrm{d}}{\mathop{}\!\mathrm{d}#1}}\)</span></p>
<p><a href="/pages/CH-index.html">&raquo;chaos</a><a href="/pages/map.html">&raquo;maps</a><a href="/pages/cds.html">&raquo;stability</a><a href="/pages/plasma.html">&raquo;plasmas</a></p>
<h1>From Hamilton equations to the nonlinear&nbsp;resonance</h1>
<p>Classical mechanics, which describes the motion of particles based on Newton&#8217;s laws, can be formulated using a Lagrangian <span class="math">\(L = L(x, \dot{x})\)</span> and the principle of least&nbsp;action:
</p>
<div class="math">$$ S[x] = \int_{x_0}^{x_1} \Di{t} L(x(t), \dot{x}(t)) \,, \quad
  \delta S[x] = 0$$</div>
<p>
where the Lagrangian is considered as a function of the trajectory <span class="math">\(x=x(t)\)</span>, and the extremum of the action functional <span class="math">\(S = S[x]\)</span> is over all trajectories joining the fixed points <span class="math">\(x_0\)</span> and <span class="math">\(x_1\)</span>. An equivalent description is obtained, after a Legendre&nbsp;transformation:
</p>
<div class="math">$$H(x,p) = \dot{x} p - L(x, \dot{x}) $$</div>
<p>
in terms of the Hamiltonian <span class="math">\(H = H(x,p)\)</span>, considered as a function of the <em>canonical variables</em> position <span class="math">\(x\)</span> and momentum <span class="math">\(p = \partial L/ \partial \dot{x}\)</span>. While the Lagrangian description is based on the particle trajectories, the Hamiltonian description is based on the distribution of states in the phase space; states are points <span class="math">\((x,p)\)</span>, belonging to an energy surface <span class="math">\(E = H(x,p)\)</span>. In the Hamiltonian dynamics approach, time appears as a simple parameter: <span class="math">\((x(t),p(t))\)</span> is the parametric definition of a phase space&nbsp;trajectory.</p>
<p>The particle dynamics is governed by the Hamiltonian equations (equivalent to the Newton equation of motion, but in fact more general than Newton&nbsp;equations):
</p>
<div class="math">$$\frac{\D x}{\D t} = \frac{\partial H}{\partial p},\quad \frac{\D p}{\D t} = -\frac{\partial H}{\partial x}.$$</div>
<p>
One can take these equations as a definition of the canonical variables <span class="math">\((x,p)\)</span>.</p>
<h2>Canonical&nbsp;transformations</h2>
<p>A change of canonical variables that preserves the Hamiltonian structure, is called a <em>canonical transformation</em>. An important type of canonical transformation, the one transforming momentum <span class="math">\(p\)</span> and position <span class="math">\(x\)</span> to action <span class="math">\(I\)</span> and angle <span class="math">\(\theta\)</span> variables, is generated by the action <span class="math">\(S = S(x,I)\)</span>:
</p>
<div class="math">$$p = \frac{\partial S}{\partial x}\,, \quad
  \theta = \frac{\partial S}{\partial I}\,, \quad
  I = \oint \Di{x} \cdot p\,.$$</div>
<p>
A system of <span class="math">\(d\)</span> degrees of freedom is integrable if it possesses <span class="math">\(d\)</span> independent integrals of motion <span class="math">\(F=\{F_1,\ldots,F_d\}\)</span>, that is phase space functions commuting with the Hamiltonian <span class="math">\(\{H,F\}=0\)</span>, where <span class="math">\(\{\ldots\}\)</span> is the Poisson braket. In an integrable systems the action variables depend only on initial conditions, or equivalently, on the set <span class="math">\(F\)</span>, allowing a trivial integration of the&nbsp;system:
</p>
<div class="math">$$I = I(F) = \text{const.}\,, \quad
  \theta = \theta_0 + \omega t\,, \quad
  \omega = \frac{\partial H}{\partial I}\,,$$</div>
<p>
where <span class="math">\(\omega=(\omega_1,\ldots,\omega_d)\)</span> are the natural frequencies of the system: basically an integrable system can be transformed, by a canonical transformation, in a set of independent oscillators. Trajectories of an integrable systems fill <em>invariant tori</em> labeled by the actions <span class="math">\(I\)</span>, and parametrically defined by the angles <span class="math">\(\theta=\theta(t)\)</span>.</p>
<p>When the number of motion integrals is smaller than the degrees of freedom, generically the Hamiltonian system is not integrable. Let us consider a small perturbation <span class="math">\(V\)</span>, of typical amplitude <span class="math">\(\varepsilon\)</span>, of an integrable Hamiltonian <span class="math">\(H_0\)</span>:
</p>
<div class="math">$$H(I,\theta) = H_0(I) + \varepsilon V(I, \theta) =
  H_0(I) + \varepsilon \sum_n V_n \E^{\I n \cdot \theta}$$</div>
<p>
where we expanded the perturbation in a Fourier series, and <span class="math">\(n = (n_1,\ldots,n_d)\)</span> is a vector of integers. Using the equations of motion, we readily obtain the first order&nbsp;approximation:
</p>
<div class="math">$$I_j = I_{0j} - \I\varepsilon \sum_n \frac{n_j V_n(I_0)}{n \cdot \omega}
  \E^{\I n \cdot \omega t + \I n \cdot \theta_0}\,, \quad j = 1, \ldots, d\,. \tag{1}$$</div>
<p>
We observe that this expansion breaks down when the linear combinations of frequencies&nbsp;vanish:
</p>
<div class="math">$$n \cdot \omega = n_1 \omega_1 + \ldots + n_d \omega_d = 0\,,$$</div>
<p>
this is the so called <em>resonance</em> condition. In the simplest case <span class="math">\(d=2\)</span>, this relation is always satisfied when the frequency ratio <span class="math">\(\omega_1/\omega_2\)</span> is&nbsp;rational. </p>
<h2>Liouville&nbsp;theorem</h2>
<p>The volume of a set of phase space trajectories is conserved. Equivalently, the Jacobian of a canonical transformation is one. The proof is straightforward: noting <span class="math">\((x,p)\)</span> the set of original variables (<span class="math">\(x\in\mathbb{R}^n\)</span>, <span class="math">\(p\in\mathbb{R}^n\)</span>, for a system with n degrees of freedom), and <span class="math">\((X,P)\)</span> the transformed canonical variables, such that, using the generating function <span class="math">\(S=S(x,P)\)</span>,
</p>
<div class="math">$$ X = \frac{\partial S}{\partial P},\quad p = \frac{\partial S}{\partial x}$$</div>
<p>
the Jacobian&nbsp;writes,
</p>
<div class="math">$$J=\left|\frac{\partial(x,p)}{\partial(X,P)}\right|.$$</div>
<p>
Using the derivation chain rule one&nbsp;obtains,
</p>
<div class="math">$$J=\frac{\left|\frac{\partial(x,p)}{\partial(x,P)}\right|}{\left|\frac{\partial(X,P)}{\partial(x,P)}\right|}=
\frac{\left|\frac{\partial p}{\partial P}\right|}{\left|\frac{\partial X}{\partial x}\right|}=
\frac{\left|\frac{\partial^2S}{\partial P\partial x}\right|}{\left|\frac{\partial^2S}{\partial x \partial P}\right|}=1$$</div>
<p>As a consequence, the phase space density <span class="math">\(\rho=\rho(x,p,t)\)</span> (its integral gives the phase space volume) is conserved along the&nbsp;trajectories:
</p>
<div class="math">$$0=\frac{\D \rho}{\D t} = \frac{\partial \rho}{\partial t} + \frac{\partial \rho}{\partial x}\frac{\D x}{\D t} + \frac{\partial \rho}{\partial p}\frac{\D p}{\D t} = \frac{\partial \rho}{\partial t} + \frac{\partial \rho}{\partial x}\frac{\partial H}{\partial p} - \frac{\partial \rho}{\partial p}\frac{\partial H}{\partial x}$$</div>
<p>
or using the Poisson bracket&nbsp;notation:
</p>
<div class="math">$$\frac{\partial \rho}{\partial t} + \{\rho,H\}=0,$$</div>
<p>
which is the <em>Liouville equation</em>.</p>
<h2><span class="caps">KAM</span> and <span class="caps">PB</span>&nbsp;theorems</h2>
<p>The Kolmogorov-Arnold-Moser theorem states that closed surfaces of energy (family of periodic orbits) are preserved under small perturbations. This theorem applies to <em>irrational tori</em>, surfaces characterized by irrational frequency ratios; for a rational frequency ratio, the Poincaré-Birkhoff theorem states that a small perturbation destroys the rational surface but creates two fixed points, at the intersection of two neighboring irrational surfaces rotating in opposite directions around the unperturbed periodic&nbsp;orbit.</p>
<h2>Perturbation&nbsp;theory</h2>
<p>Assume an <span class="math">\(N\)</span>-dimensional integrable system with Hamiltonian <span class="math">\(H_0(I)\)</span> depending on the set <span class="math">\(I=(I_1,\ldots,I_N)\)</span> action variables, altered by a small perturbation <span class="math">\(\epsilon H_1(\theta,I)\)</span>, where <span class="math">\(\epsilon\)</span> the perturbation strength, and <span class="math">\(\theta=(\theta_1,\ldots,\theta_N)\)</span> the conjugated canonical angles. Assuming that the perturbed system remains integrable, there should exist a complete set of action variables in which the hamiltonian becomes independent of the angle variables. If such is the case, exact integration of the perturbed system reduces to find a canonical transformation <span class="math">\((\theta,I)\rightarrow(\phi,J)\)</span> such that the transformed Hamiltonian&nbsp;writes 
</p>
<div class="math">$$H=H_0(I) + \epsilon H_1(\theta,I) \rightarrow K=K(J)\,.$$</div>
<p>
In general it is impossible to find a closed form of <span class="math">\(K\)</span>, however, the presence of a small parameter <span class="math">\(\epsilon\)</span> allows us to compute <span class="math">\(K\)</span> as a series in powers of <span class="math">\(\epsilon\)</span>. The idea is to use the generating function of the canonical transformation <span class="math">\(\theta \cdot J + S(\theta,J)\)</span>,
</p>
<div class="math">$$\phi=\theta + \frac{\partial S}{\partial J},\;
I = J + \frac{\partial S}{\partial \theta},\quad S = \epsilon S_1 + \cdots$$</div>
<p>
to compute the perturbation series. To first order <span class="math">\(K(J) = K_0(J)+K_1(J)\)</span>, one&nbsp;obtains,
</p>
<div class="math">$$K_0(J) = H_0(J),\; K_1(J) = \omega_0(J) \cdot \frac{\partial S_1}{\partial \theta} + H_1(\theta,J),$$</div>
<p>
where
</p>
<div class="math">$$\omega_0(I) = \frac{\partial}{\partial I} H_0(I) = \omega_0(J),$$</div>
<p>
are a set of characteristic frequencies of the original integrable system (at this order <span class="math">\(I=J\)</span>). Using the fact that <span class="math">\(K_1\)</span> do not depend on <span class="math">\(\theta\)</span>, one can average the first order equation over the angles to&nbsp;get,
</p>
<div class="math">$$K_1(J)=\int_0^{2\pi}\frac{\D\theta}{(2\pi)^N} \, H_1(\theta,J).$$</div>
<p>
Now, to find <span class="math">\(S_1\)</span> it is convenient to expand it (and <span class="math">\(H_1\)</span>) in Fourier&nbsp;series:
</p>
<div class="math">$$S_1(\theta,J) = \sum_n s_n \E^{\I n \cdot \theta},\quad H_1(\theta,J) = \sum_n h_n \E^{\I n \cdot \theta}$$</div>
<p>
with <span class="math">\(n=(n_1,\ldots,n_N)\)</span> a set of integers. After substitution of these expansions in the first order equation, one finds the form of the Fourier&nbsp;coefficients:
</p>
<div class="math">$$S_1(\theta,J) = \sum_n \frac{h_n \E^{\I n \cdot \theta}}{n\cdot \omega_0(J)}$$</div>
<p>
Already at this order, one observes the difficulty with the perturbation series: it diverges in the case of a&nbsp;resonance:
</p>
<div class="math">$$n\cdot\omega_0=0$$</div>
<p>
which is always the case if the unperturbed frequencies ratios are rational <span class="math">\(\omega_n/\omega_m\in \mathbb{Q}\)</span>. Even in the absence of a resonance, there exists a combination of integers <span class="math">\(n\)</span> such that the denominator becomes arbritarly small, making the perturbation series meaningless: this is the problem of small divisors. In summary, general perturbations should brake the integrability of the system, leading to the appearance of chaotic regions in phase&nbsp;space.</p>
<h2>Resonance</h2>
<p>In order to illustrate the behavior of a system near a resonance, we consider a one degree of freedom Hamiltonian <span class="math">\(H_0 = H_0(I)\)</span> whose natural frequency is <span class="math">\(\omega(I) = dH_0/dI\)</span>, perturbed by a time dependent potential <span class="math">\(V(I, \theta, t)\)</span>; this can be considered as a &#8220;1+1/2&#8221; Hamiltonian system (the canonical conjugate of <span class="math">\(t\)</span> being&nbsp;trivial):
</p>
<div class="math">$$H = H_0 + \varepsilon V(I, \theta, t)\,, \quad
  V(I, \theta, t) = \frac{1}{2}\sum_{k,n} V_{kn} \E^{\I k \theta - 2\pi n t/T}$$</div>
<p>
where <span class="math">\(T\)</span> is the period of the perturbation. The resonance condition, for a fixed action <span class="math">\(I_0\)</span> of some periodic orbit,&nbsp;writes 
</p>
<div class="math">$$k_0 \omega(I_0) - n_0 \nu = 0\,, \quad \nu = 2\pi/T\,.$$</div>
<p>
The equations of motion for this particular mode&nbsp;are,
</p>
<div class="math">$$\dot{I} = \varepsilon k_0 V_0 \sin(k_0 \theta - n_0\nu t)\,,\quad
  \dot{\theta} = \omega(I) + \varepsilon \frac{\D V_0}{\D I} \cos(k_0 \theta - n_0\nu t)$$</div>
<p>
where <span class="math">\(V_0\)</span> is the potential amplitude of the resonant mode. To compute the dynamics near the resonance <span class="math">\(I \approx I_0\)</span>, we use the canonical transformation (near the identity) <span class="math">\(F(I, q, t)= - (I-I_0)(q+n_0 t)/k_0\)</span>. This transformation gives new angle and action&nbsp;variables 
</p>
<div class="math">$$q=k_0 \theta - n_0 t\,, \quad
p=-\partial F/\partial q= (I-I_0)/k_0\,,$$</div>
<p> 
where <span class="math">\(q\)</span> represents the resonant phase, and the momentum <span class="math">\(p\)</span> measures the distance to the unperturbed action. The motion equations in these new variables, up to small terms in <span class="math">\(p^2\)</span> and <span class="math">\(\varepsilon\)</span>,&nbsp;are
</p>
<div class="math">$$\dot{p} = \varepsilon V_0 \sin q = -\frac{\partial H_r}{\partial q} \,, \quad
  \dot{q} = k_0 \omega(I_0 + k_0 p) - n_0 \nu = 
  \left. \frac{\D \omega}{\D I} \right|_{I_0}\, k_0^2 p =
  \frac{\partial H_r}{\partial p}$$</div>
<p>
where we expanded <span class="math">\(\omega(I)\)</span> in powers of <span class="math">\(p\)</span>, and noted that the new equations can be derived from the&nbsp;Hamiltonian:
</p>
<div class="math">$$H_r(p,q) = \frac{p^2}{2M} - K \cos q\,, \quad
  \frac{1}{M} = \left. \frac{\D^2 H_0}{\D I^2}\right|_{I_0} =
  k_0^2 \omega'(I_0)\,, \;
  K = \varepsilon V_0\,.$$</div>
<p>
We thus found that the effective Hamiltonian describing the phase space in the neighborhood of a resonance is given by the pendulum Hamiltonian. The characteristic oscillation frequency of the pendulum is <span class="math">\(\sqrt{\varepsilon k_0^2 \omega'(I_0)V_0}\)</span>.</p>
<p>From this simple model, we can imagine a Hamiltonian system with an infinite number of resonances <span class="math">\(p_1,\ldots,p_n,\ldots\)</span>. If neighboring resonances are overlapping, a particle can jump from one to the other, wandering in phase space between the resonances network. This discrete &#8220;time&#8221; dynamics can be modeled by a mapping of the&nbsp;form:
</p>
<div class="math">$$p_{n+1} = p_n + K \sin q_n\,, \quad
  q_{n+1} = q_n + p_{n+1}\,,$$</div>
<p>
which is called the <em>standard map</em>.</p>
<p><a href="/pages/CH-index.html">&raquo;chaos</a><a href="/pages/map.html">&raquo;maps</a><a href="/pages/cds.html">&raquo;stability</a><a href="/pages/plasma.html">&raquo;plasmas</a></p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "true";

    if (true) {
        align = (screen.width < 700) ? "left" : align;
        indent = (screen.width < 700) ? "0em" : indent;
        linebreak = (screen.width < 700) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>
</article>
      </div>
    </div>

    <footer class="footer">
      <div class="container">
        <div class="row">
          <ul class="col-sm-6 list-inline">
            <li class="list-inline-item"><a href="/archives.html">Archives</a></li>
            <li class="list-inline-item"><a href="/categories.html">Categories</a></li>
              <li class="list-inline-item"><a href="/tags.html">Tags</a></li>
          </ul>
          <p class="col-sm-6 text-sm-right text-muted">
          <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a> / <a href="https://getbootstrap.com" target="_blank"><img alt="Bootstrap" src="/theme/css/bootstrap-solid.svg" style="height: 18px;"/></a> / <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License Non-Commercial 4.0" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a> CC 4.0
          </p>
        </div>
      </div>
    </footer>
  </body>

</html>