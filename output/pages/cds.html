<!DOCTYPE html>
<html lang="en">

  <head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Classical dynamical systems | Random physics
</title>
    <link rel="canonical" href="/pages/cds.html">

    <link rel="stylesheet" href="/theme/css/bootstrapr.min.css">
    <link rel="stylesheet" href="/theme/css/font-awesome.min.css">
    <link rel="stylesheet" href="/theme/css/pygments/autumn.min.css">
    <link rel="stylesheet" href="/theme/css/style.css">

    <link rel="icon" type="image/png" href="/extras/rphys.png" sizes="64x64">

<meta name="description" content="Basic concepts in classical dynamical systems, from stability of trajectories to chaos and complexity.">

  </head>

  <body>
    <header class="header">
      <div class="container">
        <div class="row">
          <div class="col-sm-12">
            <h1 class="title"><a href="/">Random physics</a></h1>
            <p class="text-muted">Alberto Verga, research notebook</p>
              <ul class="list-inline">
                  <li class="list-inline-item"><a href="/">Blog</a></li>
                      <li class="list-inline-item text-muted">|</li>
                      <li class="list-inline-item"><a href="/pages/about.html">About</a></li>
                      <li class="list-inline-item"><a href="/pages/lectures.html">Lectures</a></li>
              </ul>
          </div>
        </div>
      </div>
    </header>

    <div class="main">
      <div class="container">

<article class="article">
  <div class="content">
    <p><span class="math">\(\newcommand{\I}{\mathrm{i}} \newcommand{\E}{\mathrm{e}}&nbsp;\newcommand{\D}{\mathop{}\!\mathrm{d}}\)</span></p>
<p><a href="/pages/CH-index.html">&raquo;chaos</a><a href="/pages/map.html">&raquo;map</a><a href="/pages/hamilton.html">&raquo;hamiltonian systems</a><a href="/pages/plasma.html">&raquo;plasmas</a></p>
<h2>Stability</h2>
<p>A continuous time dynamical system <span class="math">\(x(t)\)</span> is governed by a differential&nbsp;equation
</p>
<div class="math">$$\dot{x} = F_a(x,t)$$</div>
<p>
where the law <span class="math">\(F\)</span>, which determines the evolution of <span class="math">\(x\)</span>,  depends in general on a set of parameters <span class="math">\(a\)</span>. Therefore, the evolution of the dynamical variable, solution of this equation, will depend on the inital condition <span class="math">\(x_0\)</span> together with the set <span class="math">\(a\)</span>: <span class="math">\(x=x_a(t; x_0)\)</span>. Changes in the values of <span class="math">\(a\)</span> may change the qualitative behavior of <span class="math">\(x(t)\)</span>. For instance, the <em>topology</em> of the family <span class="math">\(x_a(t; x_0)\)</span> for a set of initial conditions, may change at some specific value <span class="math">\(a=a_*\)</span>. The topology of the family of trajectories, which is similar to a vector field, is largely determined by the <em>fixed points</em> <span class="math">\(X\)</span>,
</p>
<div class="math">$$F_a(x, t) = 0,\quad
x=X_n,\; n=0,1,\ldots$$</div>
<p>
and the behavior of the trajectories in the neighborhood of these fixed point. For instance, a fixed point <span class="math">\(X_0\)</span> is say to be <a href="http://www.scholarpedia.org/article/Stability"><em>stable</em></a> if neighboring trajectories stick near <span class="math">\(X_0\)</span> for long times, if initially they were near <span class="math">\(X_0\)</span> (Lyapounov stability). One useful method to determine the stability of a fixed point consists in the <em>linearization</em> of the evolution equation around the fixed point, <span class="math">\(x=X+\Delta x\)</span>:
</p>
<div class="math">$$\Delta\dot{x} = \left.\frac{\partial F}{\partial x}\right|_X\,\Delta x = M(X) \Delta X\,,$$</div>
<p>
which, according to the values of the complex eigenvalues <span class="math">\(\lambda\)</span> of the matrix <span class="math">\(M(X)\)</span>, leads to the&nbsp;classification:</p>
<ul>
<li>
<p><span class="math">\(X\)</span> is stable if <span class="math">\(\mathrm{Re}\, \lambda &lt; 0\)</span>, otherwise, if <span class="math">\(\mathrm{Re} \, \lambda &gt; 0\)</span>, there exists a solution with <span class="math">\(x(t) \rightarrow \infty\)</span> for <span class="math">\(t \rightarrow \infty\)</span>.</p>
</li>
<li>
<p>for purely imaginary eigenvalues <span class="math">\(\mathrm{Re}\, \lambda = 0\)</span> (conjugate pairs), neighboring trajectories of <span class="math">\(X\)</span>, are <em>periodic</em>.</p>
</li>
</ul>
<p>A stable fix point is the simplest <em>attractor</em>, an invariant subset of the phase space resulting from the asymtotic contraction of trajectories initially occupying a large volume of the phase&nbsp;space.</p>
<h3>Example: Kelvin-Helmholtz&nbsp;instability</h3>
<blockquote></blockquote>
<table>
<tr style="text-align:center">
<td><img src="/images/rollup06.jpg" alt="iterates" style="height: 130px;"/></td>
<td><img src="/images/rollup09.jpg" alt="bifurcations" style="height: 130px;"/></td>
<td><img src="/images/rollup12.jpg" alt="histogram" style="height: 130px;"/></td>
</tr>
<tr style="text-align:center">
<td colspan="3"> Visualization of the flow around a plate moving in a fluid </td>
</tr>
</table>

<p>A tangential discontinuity of the velocity field <span class="math">\(\boldsymbol{v}\)</span> in a potential two dimensional flow is characterized by the vorticity density distribution, the jump in the velocity <span class="math">\(\kappa = v_\parallel^{(+)} - v_\parallel^{(-)}\)</span> parallel to the discontinuity&nbsp;line:
</p>
<div class="math">$$\kappa(s,t) \D s = \D\Gamma(s),\quad
\frac{\D \Gamma}{\D t} = 0$$</div>
<p>
where <span class="math">\(\Gamma(s)\)</span> is the circulation of the velocity field at the point <span class="math">\(s\)</span> of the discontinuity line <span class="math">\(\ell\)</span>. Moreover, in an ideal fluid, the circulation is conserved. The velocity field satisfies, outside the vortex line <span class="math">\(\ell\)</span>, Poisson&nbsp;equation
</p>
<div class="math">$$\boldsymbol v = \nabla \phi,\quad \nabla^2 \phi = 0,\quad (x,y) \not\in \ell$$</div>
<p>
Using a representation of the <span class="math">\((x,y)\)</span> plane in terms of the complex variable <span class="math">\(z = x + \I y\)</span>, the Biot-Savart equation&nbsp;reads,
</p>
<div class="math">$$v_x - \I v_y = \bar{v} = \frac{1}{2\pi \I} \int_\ell \D s \frac{\kappa(s,t)}{z - Z(s,t)}$$</div>
<p>
where the line <span class="math">\(z=Z\)</span>, is parametrized by <span class="math">\(Z = Z(s,t)\)</span>, and <span class="math">\(v\)</span> is the complex velocity. From potential theory, the velocity field at the discontinuity is given by the mean <span class="math">\(V= (v^{(+)}+v^{(-)})/2\)</span>:
</p>
<div class="math">$$V = \frac{\D \overline{Z(\Gamma,t)}}{\D t} =
\mathrm{PV} \int \frac{\D \Gamma'}{2\pi \I}
\frac{1}{Z(\Gamma,t) - Z(\Gamma',t)}$$</div>
<p>
known as the <a href="http://www.scholarpedia.org/article/Kelvin-Helmholtz_Instability_and_Roll-up">Birkhoff-Rott equation</a>.</p>
<p>A fixed point <span class="math">\(\D \bar{Z}/\D t = 0\)</span> is simply given by the straight line <span class="math">\(Z(\Gamma,t) = \Gamma/U\)</span>, if the vorticity distribution is uniform and <span class="math">\(U=v_\parallel^{(+)} - v_\parallel^{(-)}\)</span> is the tangential velocity jump. A periodic perturbation <span class="math">\(\Delta Z\)</span> of the stationary solution, can be decomposed in fourier modes of wavenumber <span class="math">\(k = 2\pi n/L\)</span> (we take units such that <span class="math">\(U=1\)</span> and <span class="math">\(L=1\)</span>):
</p>
<div class="math">$$Z(\Gamma,t) = \Gamma + \sum_{n\in \mathbb{Z}} a_n(t)\, \E^{\I 2\pi n \Gamma} = \Gamma + \Delta Z(\Gamma,t)\,,$$</div>
<p>
in these units, the periodicity is <span class="math">\(L=1\)</span>, <span class="math">\(Z(\Gamma + 1, t) = Z(\Gamma,t) + 1\)</span>. Inserting the perturbation into the Birkhoff-Rott equation, and linearizing one&nbsp;obtains,
</p>
<div class="math">$$\frac{\D \overline{\Delta Z}}{\D t} = -\mathrm{PV} \int \frac{\D \Gamma'}{2\pi \I}
\frac{\Delta Z(\Gamma,t) - \Delta Z(\Gamma',t)}{|\Gamma - \Gamma'|^2}$$</div>
<p>
or, using <span class="math">\(u = \Gamma'-\Gamma\)</span>,
</p>
<div class="math">$$\sum_n \frac{\D \bar{a}_n}{\D t} \E^{-\I 2\pi n \Gamma} =
-\sum_n a_n \E^{\I 2\pi n \Gamma}\, \mathrm{PV}\int_{-\infty}^{\infty}
\frac{\D u}{2\pi\I}
\frac{1-\E^{\I 2\pi n u}}{u^2}\,.$$</div>
<p>
The principal value integral gives <span class="math">\(\pi |n|/\I\)</span>, therefore, equating similar terms one&nbsp;obtains,
</p>
<div class="math">$$\frac{\D \bar{a}_n}{\D t} = \I\pi |n| a_{-n}$$</div>
<p>
which leads, after integration, to an exponentially growing function, with growth rate <span class="math">\(\sigma\)</span> proportional to the perturbation&nbsp;wavenumber:
</p>
<div class="math">$$a_n(t) = a_n(0) \E^{\sigma_n t}, \quad \sigma_n = \pi |n|\,.$$</div>
<p>
In the original units, a perturbation of wavelength <span class="math">\(L/n\)</span> of a discontinuity <span class="math">\(U\)</span> grows in time with the&nbsp;rate
</p>
<div class="math">$$\sigma_n = \frac{\pi U}{L}|n|,\quad \sigma_k = U |k|/2\,.$$</div>
<h4>Numerics</h4>
<p>The dynamics of a <em>periodic</em> vortex line <span class="math">\(z=x + i y = Z(s,t)\)</span> is governed by the Birkhoff-Rott&nbsp;equation,
</p>
<div class="math">$$\frac{\partial}{\partial t}\bar{Z}(s,t)=
    \mathrm{PV} \int \frac{\D s'}{{2\I}} \kappa(s',t)
        \cot\left[\pi(Z(s,t)-Z(s',t))\right]\,,$$</div>
<p>
where <span class="math">\(\kappa(s,t)=|\partial Z/\partial \Gamma|^{-1}\)</span> is the intensity, and a Coulomb like potential in <span class="math">\(\ln \sin r\)</span> instead of the <span class="math">\(\ln r\)</span> (distance <span class="math">\(r\)</span>), adapted to the two dimensional domain with periodic boundary conditions is the <span class="math">\(x\)</span>&nbsp;direction.</p>
<p>The tangential discontinuity can be approximated by a one dimensional <em>array of point vortices</em> interacting with a <span class="math">\(\ln \sin \pi r_{ij}\)</span> type potential, where <span class="math">\(r_{ij}\)</span> is the separation between pairs <span class="math">\((i,j)\)</span> of the point vortices. The motion of a given point vortex results from its interaction with all other vortices: a given point vortex is advected by the velocity field created by the other point&nbsp;vortices,
</p>
<div class="math">$$\frac{\D}{\D t}(x_j- i y_j)=\frac{1}{2N}\sum_{k=1}^N
        \frac{\sinh Y_{jk}+ i \sin X_{jk}}{
            \cosh Y_{jk}-\cos X_{jk}+\delta^2}\,,$$</div>
<p>
where <span class="math">\(\delta\)</span> is a regularization parameter and <span class="math">\(X_{jk}=2\pi(x_j-x_k)\)</span> and <span class="math">\(Y_{jk}=2\pi(y_j-y_k)\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Vortex sheet motion</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">velocity</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">N</span><span class="p">:]</span>
    <span class="n">vx</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">vy</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span> <span class="o">+</span> <span class="n">cosh</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">vx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">sinh</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">/</span><span class="n">N</span>
        <span class="n">vy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sin</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">/</span><span class="n">N</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">vx</span><span class="p">,</span><span class="n">vy</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
</code></pre></div>

<p><img src="/images/rollup_kh0.png" alt="iterates" style="height: 230px;"/></p>
<p>One may use the ode <a href="https://docs.scipy.org/doc/scipy/reference/tutorial/integrate.html">scipy integrator</a> <code>X = integrate.odeint(velocity, X0, t, args=(delta,))</code> to generate an array of point vortices <span class="math">\(X = (x(t),y(t))\)</span> trajectories, and plot it at different times (see&nbsp;figure).</p>
<h2>Bifurcations</h2>
<p>The nature of a fixed point <span class="math">\(X\)</span> can change at particular values of the parameters <span class="math">\(a=a_*\)</span>, for instance a stable point becomes unstable. Changes of this kind, called <em>bifurcations</em>, are controled by the nonlinearities. Typical examples are the one dimensional dynamical systems depending on one parameter, such that the saddle-node&nbsp;bifurcation:
</p>
<div class="math">$$\dot{x} = a - x^2 \tag{SNb}$$</div>
<p>
or the pitchfork&nbsp;bifurcation
</p>
<div class="math">$$\dot{x} = ax - x^3 \tag{Pb}$$</div>
<p>
For the SNb there is no fixed point for <span class="math">\(a&lt;0\)</span> and two fixed points for <span class="math">\(a&gt;0\)</span>, one stable (<span class="math">\(x=\sqrt{a})\)</span> and one unstable (<span class="math">\(x=-\sqrt{a}\)</span>). The Pb describes instead the splitting of a stable fixed point <span class="math">\(x=0\)</span> for <span class="math">\(a&lt;0\)</span>, into two stable points <span class="math">\(x=\pm\sqrt{a}\)</span> for <span class="math">\(a&gt;0\)</span>. Increasing the dimension of the phase space and the parameter space lead to a rich variety of bifurcations. In two dimensions, one has for example the Hopf bifurcation that give rise to a limiting&nbsp;cycle:
</p>
<div class="math">$$\dot{r} = ar -r^3, \quad \dot{\theta} = 1 + br^2$$</div>
<p>
in polar coordinates: for <span class="math">\(a\le0\)</span> the origin is a stable spiral (contracting algebraically if <span class="math">\(a=0\)</span>), while for <span class="math">\(a&gt;0\)</span>, the circle <span class="math">\(r=\sqrt{a}\)</span> is attracting (limit&nbsp;cycle).</p>
<h3>Example: Swift-Hohenberg&nbsp;equation</h3>
<p>In the description of the convection of a fluid heated from below appears the <a href="https://dx.doi.org/10.1103/PhysRevA.15.319">Swift-Hohenberg equation</a>, which describes the slow mode <span class="math">\(u(x,y,t)\)</span> of velocity field and thermal fields (noting the derivatives by&nbsp;indices):
</p>
<div class="math">$$u_t = ru - \big(\partial_x^2 + 1\big)^2 u - u^3 \tag{SH}\,,$$</div>
<p>
where <span class="math">\(r\)</span> is the bifurcation parameter. The linear dispersion&nbsp;relation,
</p>
<div class="math">$$\sigma(k) = r - (k^2 - 1)^2\,,$$</div>
<p>
describes the Rayleigh-Bénard instability of tha stable solution <span class="math">\(u=0\)</span> for <span class="math">\(r&lt;0\)</span> to an unstable one for <span class="math">\(r&gt;0\)</span>, analogous to the pitchfork bifurcation. The amplitude of the unstable modes will obviously increase exponentially with a rate <span class="math">\(\sigma(k)\)</span>, but they will also possess a spatial structure, given by any stationary solution of <span class="caps">SH</span>.</p>
<p>In one dimension, for <span class="math">\(r&gt;0\)</span> the growth of an unstable mode can be described&nbsp;by 
</p>
<div class="math">$$u(x,t) = \E^{\sigma t} f(x),\quad
rf(x) = (\partial_x^2 +1)^2f(x)\,,$$</div>
<p>
at the critical point <span class="math">\(r=0\)</span> we can take the <span class="math">\(k=1\)</span>&nbsp;mode:
</p>
<div class="math">$$u(x,t) = \cos(x)\,, \quad \sigma = 0\,,$$</div>
<p>
which gives a spatially periodic pattern. A perturbation of this periodic pattern, after a transitory of exponential growth, will saturate to some asymptotic value: indeed, for large <span class="math">\(u\)</span> the nonlinear term cannot be neglected. To analyze the saturation at the critical point, we assume that the asymptotic solution has the same periodicity as the initial&nbsp;field:
</p>
<div class="math">$$u(x) = A \cos(x)\,.$$</div>
<p>
Substituting into <span class="caps">SH</span>, and neglecting high order terms in <span class="math">\(r\)</span> and higher spatial harmonics (<span class="math">\(k=3\)</span>, etc.), one readily&nbsp;obtains:
</p>
<div class="math">$$A = \sqrt{\frac{4r}{3}}$$</div>
<p>
which is the saturation amplitude of the one dimensional spatially periodic solution with wavenumber <span class="math">\(k=1\)</span>.</p>
<blockquote>
<p><img src="/images/sh.png" alt="SH" style="height: 200px;"/>
<img src="/images/sh-log.png" alt="SH log" style="height: 200px;"/></p>
</blockquote>
<p>The above figure show the spatio-temporal diagram <span class="math">\(u(x,t)\)</span>, and the growth of the amplitude in a log plot. The exponential growth and the subsequent saturation are well reproduced, the saturation amplitude <span class="math">\(\max(u) = 0.561\)</span> coincides with the theoretical prediction given by pitchfork bifurcation&nbsp;mechanism.</p>
<p>In two dimensions one can readily generalize the analysis taking <span class="math">\(k_y=0\)</span>, which transforms the periodic one dimensional pattern in a series of parallel strips in the plane. However, other kind of instabilities arise, such as for instance a zig-zag one that ultimately will destroy the strips. The figure shows the evolution of an initially random field. The system tends to form strip domains, where the strips are differently oriented; the size of the domains growth with time&nbsp;(coarse-graining).</p>
<blockquote>
<p><img src="/images/sh-xy.png" alt="SH xy" style="height: 200px;"/></p>
</blockquote>
<h4>Numerics</h4>
<p>We describe a numerical algorithm to integrate in time, a first order equation with, in general, linear and nonlinear&nbsp;terms:
</p>
<div class="math">$$u_t = Lu + NL(u,t),$$</div>
<p>
where <span class="math">\(L\)</span> is a linear operator (<span class="math">\(L = r - (\partial_{xx} + 1)\)</span>, for the <span class="caps">SH</span> equation) in and <span class="math">\(NL\)</span> the nonlinear part (<span class="math">\(-u^3\)</span> in <span class="caps">SH</span>). An implicit solution is obtained by&nbsp;integration,
</p>
<div class="math">$$u(t+h) = e^{Lh} u(t) + 
    e^{Lh} \int_0^h dt' e^{-Lt'} NL(u,t')$$</div>
<p>
Using the mid-point formula for the integral, one obtains the approximation&nbsp;method:
</p>
<div class="math">$$u(t+h) = e^{Lh} u(t) + \frac{e^{Lh}-1}{2L}
         \big[NL(u,t+h) + NL(u,t)\big]$$</div>
<p>
which can be transformed in the predictor-corrector&nbsp;method,
</p>
<div class="math">$$u' = e^{Lh} u(t) + \frac{e^{Lh}-1}{L} NL(u,t)$$</div>
<p>
and
</p>
<div class="math">$$u(t+h) = e^{Lh} u(t) + \frac{e^{Lh}-1}{2L} 
        \big[NL(u',t+h) + NL(u,t)\big]$$</div>
<p>The spatial integration can easily be implemented using a pseudo-spectral algorithm: computing derivatives in fourier space and nonlinearities in real&nbsp;space.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">#</span>
<span class="c1"># Swift-Hohenberg equation</span>
<span class="c1"># pseudo-spectral method with integrating factor</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">fft</span>
<span class="c1">#</span>
<span class="c1"># parameters</span>
<span class="n">r</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">L</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">pi</span>

<span class="n">k</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">L</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">NT</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">ND</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NT</span><span class="o">/</span><span class="n">ND</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="c1">#</span>
<span class="c1"># integrating factor</span>
<span class="n">LL</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">E</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">dt</span><span class="o">*</span><span class="n">LL</span><span class="p">)</span>
<span class="n">EF</span> <span class="o">=</span> <span class="n">expm1</span><span class="p">(</span><span class="n">dt</span><span class="o">*</span><span class="n">LL</span><span class="p">)</span><span class="o">/</span><span class="n">LL</span>
<span class="c1">#</span>
<span class="c1"># initialize</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">L</span><span class="o">/</span><span class="n">N</span>
<span class="n">x</span>  <span class="o">=</span> <span class="n">dx</span><span class="o">*</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">u0</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">D</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">fu0</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">fu1</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">u0</span> <span class="o">=</span> <span class="mf">0.01</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">u0</span>
<span class="n">fu0</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">u0</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># time evolution</span>
<span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NT</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Nfu0</span> <span class="o">=</span> <span class="o">-</span><span class="n">fft</span><span class="p">(</span><span class="n">real</span><span class="p">(</span><span class="n">ifft</span><span class="p">(</span><span class="n">fu0</span><span class="p">))</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">fu1</span> <span class="o">=</span> <span class="n">E</span><span class="o">*</span><span class="n">fu0</span> <span class="o">+</span> <span class="n">EF</span><span class="o">*</span><span class="n">Nfu0</span>

    <span class="n">Nfu1</span> <span class="o">=</span> <span class="o">-</span><span class="n">fft</span><span class="p">(</span><span class="n">real</span><span class="p">(</span><span class="n">ifft</span><span class="p">(</span><span class="n">fu1</span><span class="p">))</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">fu0</span> <span class="o">=</span> <span class="n">E</span><span class="o">*</span><span class="n">fu0</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">EF</span><span class="o">*</span><span class="p">(</span><span class="n">Nfu0</span> <span class="o">+</span> <span class="n">Nfu1</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">t</span><span class="o">%</span><span class="n">ND</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
          <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
          <span class="n">u</span><span class="p">[</span><span class="n">it</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">real</span><span class="p">(</span><span class="n">ifft</span><span class="p">(</span><span class="n">fu0</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>

<h2>Attractors</h2>
<p>The long time behavior of dissipative systems is characterized by the contraction of the phase space volume, which tends to an asymptotic invariant set. A trivial example is given by the diffusion equation: an initial bounded concentration <span class="math">\(c(x,0)\)</span> evolves towards a uniform distribution <span class="math">\(c(x,t)\rightarrow0\)</span>. This invariant set is an <em>attractor</em> and the set of initial conditions converging to the attractor is its <em>basin of attraction</em>. The dimension of the phase space attracting set is smaller than the phase space dimension. For instance the set <span class="math">\(x(0)&gt;0\)</span> will converge to the set <span class="math">\(x=1\)</span> if <span class="math">\(\dot{x} = x - x^3\)</span>, and the set <span class="math">\(x(0)&lt;1\)</span> to <span class="math">\(x=-1\)</span>, <span class="math">\(t\rightarrow\infty\)</span>.</p>
<h3>Kuramoto-Sivashinky&nbsp;equation</h3>
<p>The <a href="https://www.encyclopediaofmath.org/index.php/Kuramoto-Sivashinsky_equation">Kuramoto-Sivashisky equation</a> appears in the study of reaction diffusion fronts, and is a model of <em>spatio-temporal chaos</em>. It can be obtained from the Ginzburg-Landau equation, which governs the evolution of a superfluid, as an effective equation for the phase of the complex order parameter. In one dimension, and using convenient units, it&nbsp;reads,
</p>
<div class="math">$$u_t + uu_x + u_{xx} + u_{xxxx} = 0, \quad x \in [-L/2,L/2] \tag{KS}$$</div>
<p>
(as before, indexes are for derivatives), where <span class="math">\(u\)</span> is related with the shape of the front (the displacement of the front with respect to a straight line). The only parameter of the system is its (nondimensional) size <span class="math">\(L\)</span>. Using a simple scaling transformation on can also write (<span class="caps">KS</span>) with a (nondimensional) viscosity parameter <span class="math">\(nu\)</span>:
</p>
<div class="math">$$u_t + uu_x + u_{xx} + \nu u_{xxxx} = 0, \quad x \in [-\pi,\pi] \tag{KSn}$$</div>
<p>
with <span class="math">\(L=2\pi/\sqrt{\nu}\)</span>.</p>
<blockquote></blockquote>
<table>
<tr style="text-align:center">
<td><img src="/images/ks-nu0.png" alt="KS xt" style="height: 130px;"/></td>
<td><img src="/images/ks-nu1.png" alt="KS xt" style="height: 130px;"/></td>
<td><img src="/images/ks-nu3.png" alt="KS xt" style="height: 130px;"/></td>
</tr>
<tr style="text-align:center">
<td><img src="/images/ks-nu0_E.png" alt="KS energy" style="height: 130px;"/></td>
<td><img src="/images/ks-nu1_E.png" alt="KS energy" style="height: 130px;"/></td>
<td><img src="/images/ks-nu3_E.png" alt="KS energy" style="height: 130px;"/></td>
</tr>
<tr style="text-align:center">
<td colspan="3"> Transition to spatio-temporal chaos in the Kuramoto-Shivashinsky equation.</td>
</tr>
</table>

<p>Varying the parameter <span class="math">\(\nu\)</span> from large values to small ones one observes transitions between different spatial and temporal patterns, form ordered to chaotic (<a href="/pdfs/Smyrlis-1991ly.pdf">Smyrlis and Papageorgiou, 1991</a>). For instance arround <span class="math">\(\nu = 0.03\)</span> the system undergoes a series of period doubling bifurcations, similar to the Feigenbaum logistic map, leading to spatio-temporal chaos (figure&nbsp;above).</p>
<p>For smaller viscosity, or equivalently, when the system&#8217;s size increases, a regime of spatio-temporal chaos prevails; it is characterized by the power&nbsp;spectrum,
</p>
<div class="math">$$S(k) = \langle | u_k(t) |^2 \rangle$$</div>
<p>
where the averaging is over time in the stationary regime. An estimation of the value of the threshold for disorder is given by the size of the most instable mode <span class="math">\(L \sim 2\pi \sqrt{2} \approx 9\)</span>. The figure below show that the large length spectrum is flat, meaning an equipartition of the energy; there is a peak around <span class="math">\(k \sim 1/\sqrt{2}\)</span>, followed by a power law region <span class="math">\(S(k) \sim k^{-4}\)</span>, and finally, an exponential&nbsp;cutoff. </p>
<blockquote></blockquote>
<table>
<tr style="text-align:center">
<td><img src="/images/ks-1.png" alt="KS chaos" style="height: 200px;"/></td>
<td><img src="/images/ks-P.png" alt="KS spectrum" style="height: 200px;"/></td>
<tr style="text-align:center">
<td colspan="2"> Spatio-temporal chaos and its spectrum $S(k)$. The inset shows the unstable wavenumber region with an interval following a power law in $S(k) \sim k^{-4}$.</td>
</tr>
</table>

<p>In summary the spectrum has the&nbsp;form,
</p>
<div class="math">$$S(k) \sim \frac{\E^{-k/k_\nu}}{k^4}$$</div>
<p>
where <span class="math">\(k_\nu\)</span> is the viscous&nbsp;cutoff.</p>
<h3>Lorenz&nbsp;system</h3>
<p>The Lorenz system results from a truncation of the hydrodynamic fluid equations describing thermal convection in a slab geometry. The velocity and temperature fields are truncated to three fourier amplitudes <span class="math">\((x,y,z)\)</span>, satisfying the set of ordinary differential&nbsp;equations:
</p>
<div class="math">\begin{align*}
\dot{x} &amp;= s(y-x)\\
\dot{y} &amp;= r x - y - xz\\
\dot{z} &amp;= -bz + xy
\end{align*}</div>
<p>
depending on the parameter set <span class="math">\((s,r,b)\)</span> related to the Prandtl number <span class="math">\(\mathrm{Pr}\)</span>, the Rayleigh number <span class="math">\(\mathrm{Ra}\)</span> and a characteristic length of the convective rolls,&nbsp;respectively.</p>
<p>The code below is a python implementation of the Lorenz&nbsp;system:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="c1"># Lorenz attractor</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">lorenz</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="n">s</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">y</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">z</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">]</span>
<span class="c1">#</span>
<span class="n">X0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># initial condition</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span> <span class="c1"># time steps</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># (s, r, b)</span>
<span class="c1">#</span>
<span class="c1"># phase space trajectory X(t), shape(X) = (t,3)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">odeint</span><span class="p">(</span><span class="n">lorenz</span><span class="p">,</span> <span class="n">X0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>

<p>The program returns a plot of the trajectory in the phase space, for the case <span class="math">\(s=10\)</span>, <span class="math">\(r=28\)</span> and <span class="math">\(b =8/3\)</span> first used by&nbsp;Lorenz.</p>
<blockquote>
<p><img src="/images/lorenz.png" alt="Lorenz attractor" style="height: 300px;"/>
<img src="/images/lorenz-x.png" alt="Lorenz attractor, x" style="height: 200px;"/></p>
</blockquote>
<p>The figure above shows the phase-space trajectory <span class="math">\(\boldsymbol{X}(t)\)</span>, <span class="math">\(\boldsymbol{X} = (x,y,z)\)</span>, for a time spaning the interval <span class="math">\(t \in (0,T=40)\)</span>, with different colors for <span class="math">\(t &lt; 0.2T\)</span> (black), <span class="math">\(0.2T&lt;t&lt;0.5T\)</span> (blue) and <span class="math">\(t&gt;0.5T\)</span> (red), to underline the structure of the attractor. It consists in two lobes, and the trajectory intermittently switch from one to the other, as can be seen in the plot <span class="math">\(x = x(t)\)</span>.</p>
<h4>Strange&nbsp;attractor</h4>
<p>Under the dynamics <span class="math">\(\dot{\boldsymbol{X}} = \boldsymbol{F}(\boldsymbol{X})\)</span> the phase-space volume <span class="math">\(V\)</span> shrinks&nbsp;exponentially:
</p>
<div class="math">$$\frac{\D}{\D t}V(t) = \int \D V\, \nabla \cdot \boldsymbol F = -(s+1+b)V\,,$$</div>
<p>
which implies that the attractor set has measure zero in the three dimensional phase-space. It is an example of <a href="/pdfs/Grassberger-1983fk.pdf">strange attractor</a>.</p>
<h4>Hydrodynamic&nbsp;equations</h4>
<p>We consider a vertical layer <span class="math">\((x,y)\)</span> of fluid of height <span class="math">\(h\)</span>, <span class="math">\(y \in (0,h)\)</span>, subject to a temperature gradient <span class="math">\((T_h - T_0)/h &lt;0\)</span>. To simplify the analysis we assume homogeneity in the horizonatal <span class="math">\(z\)</span>-direction, <span class="math">\(\nabla = (\partial_x,\partial_y,0)\)</span>. The fluid velocity <span class="math">\(\boldsymbol{v}\)</span> and the temperature <span class="math">\(T\)</span>,&nbsp;satisfy,
</p>
<div class="math">$$\rho\left( \frac{\partial }{\partial t} \boldsymbol v  +
\boldsymbol v \cdot \nabla \boldsymbol v \right) =
-\nabla p - \rho g \hat{\boldsymbol y} + \mu \nabla^2 \boldsymbol v\,,$$</div>
<p>
where <span class="math">\(\mu\)</span> is the viscosity,&nbsp;and
</p>
<div class="math">$$\frac{\partial }{\partial t} T  +
\boldsymbol v \cdot \nabla T = D \nabla^2 T\,,$$</div>
<p>
where <span class="math">\(D\)</span> is the thermal diffusivity. The temperature variation <span class="math">\(\Delta T\)</span> induces a density variation <span class="math">\(\rho = \rho(T)\)</span>, characterized by the dilatation coefficient <span class="math">\(\alpha\)</span>:
</p>
<div class="math">$$\Delta \rho = -\rho_0 \alpha \Delta T\,,\quad 
\alpha = - \frac{1}{\rho_0} \frac{\partial \rho}{\partial T}\,.$$</div>
<p>
The equilibrium solution of these equations&nbsp;is 
</p>
<div class="math">$$\boldsymbol v = 0,\; 
T_0(y) = T_0 + \frac{T_h - T_0}{h} y = T_0 - \frac{\delta T}{h}y, \;
\frac{\D p_0(y)}{\D y} = -g\rho_0(y,T) \,,$$</div>
<p>
where <span class="math">\(\delta T = T_0 - T_h &gt; 0\)</span>.&nbsp;Using 
</p>
<div class="math">$$\rho_0(y,T) = \rho_0 + \rho_0 \alpha \frac{\delta T}{h} y,$$</div>
<p>
we&nbsp;obtain,
</p>
<div class="math">$$p_0(y) = p_0 - \rho_0 g y - \rho_0 \alpha \frac{\delta T}{2h} y^2.$$</div>
<p>
Fluctuations <span class="math">\(\boldsymbol v\)</span>, <span class="math">\(\Delta T = T - T_0(y)\)</span> and <span class="math">\(\Delta p=p - p_0(y)\)</span>, once substituted into the hydrodynamic equations,&nbsp;satisfy,
</p>
<div class="math">$$\rho_0\left( \frac{\partial }{\partial t} \boldsymbol v  +
\boldsymbol v \cdot \nabla \boldsymbol v \right) =
-\nabla \Delta p + \rho_0 \alpha g \Delta T \hat{\boldsymbol y} + \mu \nabla^2 \boldsymbol v\,,$$</div>
<p>
where we neglegted variations of the density in the left hand side,&nbsp;and
</p>
<div class="math">$$\frac{\partial }{\partial t} \Delta T  +
\boldsymbol v \cdot \nabla \Delta T + v_y \frac{\delta T}{h} = D \nabla^2 \Delta T\,.$$</div>
<p>
Now, introducing the units of length <span class="math">\(h\)</span>, time <span class="math">\(h^2/D\)</span>, density <span class="math">\(\rho_0\)</span> and temperature <span class="math">\(\delta T\)</span>, and dropping the <span class="math">\(\Delta\)</span> notation for the fluctuations, we finally&nbsp;obtain
</p>
<div class="math">$$\frac{1}{\mathrm{Pr}}\left(\frac{\partial }{\partial t} \boldsymbol v  +
\boldsymbol v \cdot \nabla \boldsymbol v \right)=
-\nabla p + \mathrm{Ra} T \hat{\boldsymbol z} + \nabla^2 \boldsymbol v\,,$$</div>
<p>
and
</p>
<div class="math">$$\frac{\partial }{\partial t} T  +
\boldsymbol v \cdot \nabla T + v_y = \nabla^2 T\,,$$</div>
<p>
in adimensional form,&nbsp;where
</p>
<div class="math">$$\mathrm{Ra} = \frac{\rho_0 g h^3 \alpha \delta T}{D\mu},\;
\mathrm{Pr} = \frac{\mu}{\rho_0 D}$$</div>
<p>
are the Rayleigh and Prandtl numbers,&nbsp;respectively.</p>
<p>Introducing the stream function <span class="math">\(\psi\)</span>:
</p>
<div class="math">$$v_x=\frac{\partial }{\partial y}\psi,\;
v_y=-\frac{\partial }{\partial x}\psi\,,$$</div>
<p>
and taking the rotational of the velocity equation to eliminate the pressure gradient, we&nbsp;obtain,
</p>
<div class="math">$$\frac{1}{\mathrm{Pr}}\left(\frac{\partial }{\partial t} \nabla^2 \psi + [\psi, \nabla^2 \psi]\right) = 
\mathrm{Ra} \frac{\partial T}{\partial x}  + \nabla^4 \psi$$</div>
<p>
and
</p>
<div class="math">$$\frac{\partial }{\partial t}T + [\psi,T] - \frac{\partial }{\partial x}\psi = 
\nabla^2 T,,$$</div>
<p>
where <span class="math">\([\ldots]\)</span> is the Poisson&nbsp;bracket:
</p>
<div class="math">$$[f,g]= \frac{\partial f}{\partial x} \frac{\partial g}{\partial y} - \frac{\partial f}{\partial y} \frac{\partial g}{\partial x}\,.$$</div>
<p>The Lorenz system results from the&nbsp;Ansatz,
</p>
<div class="math">\begin{align*}
\psi(x,y,t) &amp;= p(t) \sin(kx) \sin(\pi y)\\
T(x,y,t) &amp;= a(t) \cos(kx) \sin(\pi y) - b(t) \sin(2\pi y)
\end{align*}</div>
<p>
We may use <code>sympy</code> to deduce the differential equations in the amplitudes <span class="math">\((p,a,b)\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">s</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;s, r, k&#39;</span><span class="p">,</span> <span class="n">reals</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">positive</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, y, t&#39;</span><span class="p">,</span> <span class="n">reals</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span> <span class="c1"># psi amplitude</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="c1"># temperature amplitude</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span> <span class="c1"># temperature amplitude</span>
<span class="c1">#</span>
<span class="c1"># Ansatz</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">b</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">Dt</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Dx</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Dy</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Lap</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Poisson</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">g</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">g</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># hydrodynamic equations</span>
<span class="n">eq_temp</span> <span class="o">=</span> <span class="n">Dt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">Poisson</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">Dx</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span> <span class="o">-</span> <span class="n">Lap</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="n">eq_psi</span> <span class="o">=</span> <span class="n">Dt</span><span class="p">(</span><span class="n">Lap</span><span class="p">(</span><span class="n">psi</span><span class="p">))</span> <span class="o">+</span> <span class="n">Poisson</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">Lap</span><span class="p">(</span><span class="n">psi</span><span class="p">))</span> <span class="o">-</span> <span class="n">r</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="n">Dx</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">Lap</span><span class="p">(</span><span class="n">Lap</span><span class="p">(</span><span class="n">psi</span><span class="p">))</span>
</code></pre></div>

<p>Simplification of the temperature equation: first collect the <span class="math">\(\cos(kx)\sin(\pi y)\)</span> terms, neglect the <span class="math">\(\sin(3\pi y)\)</span> term in the development of <span class="math">\(\cos(2\pi y)\sin(\pi y)\)</span>, and finally collect <span class="math">\(\sin(2\pi y)\)</span>&nbsp;terms.</p>
<div class="highlight"><pre><span></span><code><span class="n">collect</span><span class="p">(</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">collect</span><span class="p">(</span>
        <span class="n">collect</span><span class="p">(</span>
            <span class="n">expand</span><span class="p">(</span><span class="n">eq_temp</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">),</span>
            <span class="o">-</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">)),</span> 
        <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">)),</span> 
    <span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">a</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">))),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">))</span>
<span class="c1">#</span>
<span class="c1"># Output:</span>
<span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">a</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">b</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span>
<span class="p">(</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">b</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">k</span><span class="o">*</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">))</span><span class="o">*</span>
<span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p>Simplification of the stream function equation: collect terms in <span class="math">\(\sin(kx)\sin(\pi y)\)</span> and <span class="math">\(p\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="n">simplify</span><span class="p">(</span><span class="n">collect</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="n">eq_psi</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">)),</span> <span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
<span class="c1">#</span>
<span class="c1"># Output:</span>
<span class="n">k</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="n">a</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">pi</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span>
<span class="p">(</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
</code></pre></div>

<p>Collecting the coefficients of the different trigonometric functions we arrive&nbsp;at,
</p>
<div class="math">\begin{align*}
\dot{p} &amp;= -(\pi^2 + k^2) p + \frac{k s r}{\pi^2 + k^2} a\\
\dot{a} &amp;= -(\pi^2 + k^2) a + k p - \pi k b p\\
\dot{b} &amp;= -4\pi^2 b + \frac{\pi k}{2} a p
\end{align*}</div>
<p>
which are, after rescaling, the Lorenz&nbsp;equations.</p>
<h3>Bibliography</h3>
<ul>
<li>
<p><a href="http://www.stevenstrogatz.com/books/nonlinear-dynamics-and-chaos-with-applications-to-physics-biology-chemistry-and-engineering">Strogatz</a>, <span class="caps">S. H.</span> <em>Nonlinear dynamics and chaos</em> (<span class="caps">CRC</span>,&nbsp;2015).</p>
</li>
<li>
<p><a href="https://webhome.phy.duke.edu/~hsg/pattern-formation-book/">Cross</a>, M. and Greenside, H. <em>Pattern Formation</em> (Cambridge, 2009). An interesting and thorough introduction to nonlinear dynamics and nonequilibrium&nbsp;systems.</p>
</li>
</ul>
<p><a href="/pages/CH-index.html">&raquo;chaos</a><a href="/pages/map.html">&raquo;map</a><a href="/pages/hamilton.html">&raquo;hamiltonian systems</a><a href="/pages/plasma.html">&raquo;plasmas</a></p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "true";

    if (true) {
        align = (screen.width < 700) ? "left" : align;
        indent = (screen.width < 700) ? "0em" : indent;
        linebreak = (screen.width < 700) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>
</article>
      </div>
    </div>

    <footer class="footer">
      <div class="container">
        <div class="row">
          <ul class="col-sm-6 list-inline">
            <li class="list-inline-item"><a href="/archives.html">Archives</a></li>
            <li class="list-inline-item"><a href="/categories.html">Categories</a></li>
              <li class="list-inline-item"><a href="/tags.html">Tags</a></li>
          </ul>
          <p class="col-sm-6 text-sm-right text-muted">
          <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a> / <a href="https://getbootstrap.com" target="_blank"><img alt="Bootstrap" src="/theme/css/bootstrap-solid.svg" style="height: 18px;"/></a> / <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License Non-Commercial 4.0" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a> CC 4.0
          </p>
        </div>
      </div>
    </footer>
  </body>

</html>