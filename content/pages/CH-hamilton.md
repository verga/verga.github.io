Title: Hamilton formalism
Slug: hamilton 
Date: 2016-01-13 16:03
Category: Lectures
Tags: Hamiltonian formalism, chaos, resonance, standard map
Authors: Alberto Verga
Summary: Hamiltonian systems and phase space description of the dynamics; Poincaré maps; nonlinear resonance and standard map.
status: hidden

$\newcommand{\I}{\mathrm{i}} 
\newcommand{\E}{\mathrm{e}} 
\newcommand{\D}{\mathop{}\!\mathrm{d}} 
\newcommand{\Di}[1]{\mathop{}\!\mathrm{d}#1\,} 
\newcommand{\Dd}[1]{\frac{\mathop{}\!\mathrm{d}}{\mathop{}\!\mathrm{d}#1}}$

[&raquo;chaos]({filename}CH-index.md)[&raquo;maps]({filename}CH-map.md)[&raquo;stability]({filename}CH-cds.md)[&raquo;plasmas]({filename}CH-plasma.md)

# From Hamilton equations to the nonlinear resonance

Classical mechanics, which describes the motion of particles based on Newton's laws, can be formulated using a Lagrangian $L = L(x, \dot{x})$ and the principle of least action:
$$ S[x] = \int_{x_0}^{x_1} \Di{t} L(x(t), \dot{x}(t)) \,, \quad
  \delta S[x] = 0$$
where the Lagrangian is considered as a function of the trajectory $x=x(t)$, and the extremum of the action functional $S = S[x]$ is over all trajectories joining the fixed points $x_0$ and $x_1$. An equivalent description is obtained, after a Legendre transformation:
$$H(x,p) = \dot{x} p - L(x, \dot{x}) $$
in terms of the Hamiltonian $H = H(x,p)$, considered as a function of the *canonical variables* position $x$ and momentum $p = \partial L/ \partial \dot{x}$. While the Lagrangian description is based on the particle trajectories, the Hamiltonian description is based on the distribution of states in the phase space; states are points $(x,p)$, belonging to an energy surface $E = H(x,p)$. In the Hamiltonian dynamics approach, time appears as a simple parameter: $(x(t),p(t))$ is the parametric definition of a phase space trajectory.

The particle dynamics is governed by the Hamiltonian equations (equivalent to the Newton equation of motion, but in fact more general than Newton equations):
$$\frac{\D x}{\D t} = \frac{\partial H}{\partial p},\quad \frac{\D p}{\D t} = -\frac{\partial H}{\partial x}.$$
One can take these equations as a definition of the canonical variables $(x,p)$.

## Canonical transformations

A change of canonical variables that preserves the Hamiltonian structure, is called a *canonical transformation*. An important type of canonical transformation, the one transforming momentum $p$ and position $x$ to action $I$ and angle $\theta$ variables, is generated by the action $S = S(x,I)$:
$$p = \frac{\partial S}{\partial x}\,, \quad
  \theta = \frac{\partial S}{\partial I}\,, \quad
  I = \oint \Di{x} \cdot p\,.$$
A system of $d$ degrees of freedom is integrable if it possesses $d$ independent integrals of motion $F=\{F_1,\ldots,F_d\}$, that is phase space functions commuting with the Hamiltonian $\{H,F\}=0$, where $\{\ldots\}$ is the Poisson braket. In an integrable systems the action variables depend only on initial conditions, or equivalently, on the set $F$, allowing a trivial integration of the system:
$$I = I(F) = \text{const.}\,, \quad
  \theta = \theta_0 + \omega t\,, \quad
  \omega = \frac{\partial H}{\partial I}\,,$$
where $\omega=(\omega_1,\ldots,\omega_d)$ are the natural frequencies of the system: basically an integrable system can be transformed, by a canonical transformation, in a set of independent oscillators. Trajectories of an integrable systems fill *invariant tori* labeled by the actions $I$, and parametrically defined by the angles $\theta=\theta(t)$.

When the number of motion integrals is smaller than the degrees of freedom, generically the Hamiltonian system is not integrable. Let us consider a small perturbation $V$, of typical amplitude $\varepsilon$, of an integrable Hamiltonian $H_0$:
$$H(I,\theta) = H_0(I) + \varepsilon V(I, \theta) =
  H_0(I) + \varepsilon \sum_n V_n \E^{\I n \cdot \theta}$$
where we expanded the perturbation in a Fourier series, and $n = (n_1,\ldots,n_d)$ is a vector of integers. Using the equations of motion, we readily obtain the first order approximation:
$$I_j = I_{0j} - \I\varepsilon \sum_n \frac{n_j V_n(I_0)}{n \cdot \omega}
  \E^{\I n \cdot \omega t + \I n \cdot \theta_0}\,, \quad j = 1, \ldots, d\,. \tag{1}$$
We observe that this expansion breaks down when the linear combinations of frequencies vanish:
$$n \cdot \omega = n_1 \omega_1 + \ldots + n_d \omega_d = 0\,,$$
this is the so called *resonance* condition. In the simplest case $d=2$, this relation is always satisfied when the frequency ratio $\omega_1/\omega_2$ is rational. 

## Liouville theorem

The volume of a set of phase space trajectories is conserved. Equivalently, the Jacobian of a canonical transformation is one. The proof is straightforward: noting $(x,p)$ the set of original variables ($x\in\mathbb{R}^n$, $p\in\mathbb{R}^n$, for a system with n degrees of freedom), and $(X,P)$ the transformed canonical variables, such that, using the generating function $S=S(x,P)$,
$$ X = \frac{\partial S}{\partial P},\quad p = \frac{\partial S}{\partial x}$$
the Jacobian writes,
$$J=\left|\frac{\partial(x,p)}{\partial(X,P)}\right|.$$
Using the derivation chain rule one obtains,
$$J=\frac{\left|\frac{\partial(x,p)}{\partial(x,P)}\right|}{\left|\frac{\partial(X,P)}{\partial(x,P)}\right|}=
\frac{\left|\frac{\partial p}{\partial P}\right|}{\left|\frac{\partial X}{\partial x}\right|}=
\frac{\left|\frac{\partial^2S}{\partial P\partial x}\right|}{\left|\frac{\partial^2S}{\partial x \partial P}\right|}=1$$

As a consequence, the phase space density $\rho=\rho(x,p,t)$ (its integral gives the phase space volume) is conserved along the trajectories:
$$0=\frac{\D \rho}{\D t} = \frac{\partial \rho}{\partial t} + \frac{\partial \rho}{\partial x}\frac{\D x}{\D t} + \frac{\partial \rho}{\partial p}\frac{\D p}{\D t} = \frac{\partial \rho}{\partial t} + \frac{\partial \rho}{\partial x}\frac{\partial H}{\partial p} - \frac{\partial \rho}{\partial p}\frac{\partial H}{\partial x}$$
or using the Poisson bracket notation:
$$\frac{\partial \rho}{\partial t} + \{\rho,H\}=0,$$
which is the *Liouville equation*.

## KAM and PB theorems

The Kolmogorov-Arnold-Moser theorem states that closed surfaces of energy (family of periodic orbits) are preserved under small perturbations. This theorem applies to *irrational tori*, surfaces characterized by irrational frequency ratios; for a rational frequency ratio, the Poincaré-Birkhoff theorem states that a small perturbation destroys the rational surface but creates two fixed points, at the intersection of two neighboring irrational surfaces rotating in opposite directions around the unperturbed periodic orbit.

## Perturbation theory

Assume an $N$-dimensional integrable system with Hamiltonian $H_0(I)$ depending on the set $I=(I_1,\ldots,I_N)$ action variables, altered by a small perturbation $\epsilon H_1(\theta,I)$, where $\epsilon$ the perturbation strength, and $\theta=(\theta_1,\ldots,\theta_N)$ the conjugated canonical angles. Assuming that the perturbed system remains integrable, there should exist a complete set of action variables in which the hamiltonian becomes independent of the angle variables. If such is the case, exact integration of the perturbed system reduces to find a canonical transformation $(\theta,I)\rightarrow(\phi,J)$ such that the transformed Hamiltonian writes 
$$H=H_0(I) + \epsilon H_1(\theta,I) \rightarrow K=K(J)\,.$$
In general it is impossible to find a closed form of $K$, however, the presence of a small parameter $\epsilon$ allows us to compute $K$ as a series in powers of $\epsilon$. The idea is to use the generating function of the canonical transformation $\theta \cdot J + S(\theta,J)$,
$$\phi=\theta + \frac{\partial S}{\partial J},\;
I = J + \frac{\partial S}{\partial \theta},\quad S = \epsilon S_1 + \cdots$$
to compute the perturbation series. To first order $K(J) = K_0(J)+K_1(J)$, one obtains,
$$K_0(J) = H_0(J),\; K_1(J) = \omega_0(J) \cdot \frac{\partial S_1}{\partial \theta} + H_1(\theta,J),$$
where
$$\omega_0(I) = \frac{\partial}{\partial I} H_0(I) = \omega_0(J),$$
are a set of characteristic frequencies of the original integrable system (at this order $I=J$). Using the fact that $K_1$ do not depend on $\theta$, one can average the first order equation over the angles to get,
$$K_1(J)=\int_0^{2\pi}\frac{\D\theta}{(2\pi)^N} \, H_1(\theta,J).$$
Now, to find $S_1$ it is convenient to expand it (and $H_1$) in Fourier series:
$$S_1(\theta,J) = \sum_n s_n \E^{\I n \cdot \theta},\quad H_1(\theta,J) = \sum_n h_n \E^{\I n \cdot \theta}$$
with $n=(n_1,\ldots,n_N)$ a set of integers. After substitution of these expansions in the first order equation, one finds the form of the Fourier coefficients:
$$S_1(\theta,J) = \sum_n \frac{h_n \E^{\I n \cdot \theta}}{n\cdot \omega_0(J)}$$
Already at this order, one observes the difficulty with the perturbation series: it diverges in the case of a resonance:
$$n\cdot\omega_0=0$$
which is always the case if the unperturbed frequencies ratios are rational $\omega_n/\omega_m\in \mathbb{Q}$. Even in the absence of a resonance, there exists a combination of integers $n$ such that the denominator becomes arbritarly small, making the perturbation series meaningless: this is the problem of small divisors. In summary, general perturbations should brake the integrability of the system, leading to the appearance of chaotic regions in phase space.

## Resonance

In order to illustrate the behavior of a system near a resonance, we consider a one degree of freedom Hamiltonian $H_0 = H_0(I)$ whose natural frequency is $\omega(I) = dH_0/dI$, perturbed by a time dependent potential $V(I, \theta, t)$; this can be considered as a "1+1/2" Hamiltonian system (the canonical conjugate of $t$ being trivial):
$$H = H_0 + \varepsilon V(I, \theta, t)\,, \quad
  V(I, \theta, t) = \frac{1}{2}\sum_{k,n} V_{kn} \E^{\I k \theta - 2\pi n t/T}$$
where $T$ is the period of the perturbation. The resonance condition, for a fixed action $I_0$ of some periodic orbit, writes 
$$k_0 \omega(I_0) - n_0 \nu = 0\,, \quad \nu = 2\pi/T\,.$$
The equations of motion for this particular mode are,
$$\dot{I} = \varepsilon k_0 V_0 \sin(k_0 \theta - n_0\nu t)\,,\quad
  \dot{\theta} = \omega(I) + \varepsilon \frac{\D V_0}{\D I} \cos(k_0 \theta - n_0\nu t)$$
where $V_0$ is the potential amplitude of the resonant mode. To compute the dynamics near the resonance $I \approx I_0$, we use the canonical transformation (near the identity) $F(I, q, t)= - (I-I_0)(q+n_0 t)/k_0$. This transformation gives new angle and action variables 
$$q=k_0 \theta - n_0 t\,, \quad
p=-\partial F/\partial q= (I-I_0)/k_0\,,$$ 
where $q$ represents the resonant phase, and the momentum $p$ measures the distance to the unperturbed action. The motion equations in these new variables, up to small terms in $p^2$ and $\varepsilon$, are
$$\dot{p} = \varepsilon V_0 \sin q = -\frac{\partial H_r}{\partial q} \,, \quad
  \dot{q} = k_0 \omega(I_0 + k_0 p) - n_0 \nu = 
  \left. \frac{\D \omega}{\D I} \right|_{I_0}\, k_0^2 p =
  \frac{\partial H_r}{\partial p}$$
where we expanded $\omega(I)$ in powers of $p$, and noted that the new equations can be derived from the Hamiltonian:
$$H_r(p,q) = \frac{p^2}{2M} - K \cos q\,, \quad
  \frac{1}{M} = \left. \frac{\D^2 H_0}{\D I^2}\right|_{I_0} =
  k_0^2 \omega'(I_0)\,, \;
  K = \varepsilon V_0\,.$$
We thus found that the effective Hamiltonian describing the phase space in the neighborhood of a resonance is given by the pendulum Hamiltonian. The characteristic oscillation frequency of the pendulum is $\sqrt{\varepsilon k_0^2 \omega'(I_0)V_0}$.

From this simple model, we can imagine a Hamiltonian system with an infinite number of resonances $p_1,\ldots,p_n,\ldots$. If neighboring resonances are overlapping, a particle can jump from one to the other, wandering in phase space between the resonances network. This discrete "time" dynamics can be modeled by a mapping of the form:
$$p_{n+1} = p_n + K \sin q_n\,, \quad
  q_{n+1} = q_n + p_{n+1}\,,$$
which is called the *standard map*.


[&raquo;chaos]({filename}CH-index.md)[&raquo;maps]({filename}CH-map.md)[&raquo;stability]({filename}CH-cds.md)[&raquo;plasmas]({filename}CH-plasma.md)
